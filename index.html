<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ============================================
         META TAGS SECTION
         These tell the browser and phone how to display the app
         ============================================ -->
    <meta charset="UTF-8">
    <!-- Makes the app look good on phones by setting the viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- These three tags make the app work like a native iPhone app when added to home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Golf Tracker">
    <!-- Title that appears in browser tab -->
    <title>Golf Course Tracker</title>
    <!-- Favicon - the little icon shown in the browser tab -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèåÔ∏è</text></svg>">
    
    <!-- ============================================
         FIREBASE - CLOUD SYNC
         Enables syncing data across all your devices
         ============================================ -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <!-- ============================================
         CSS STYLES SECTION
         This controls how everything looks (colors, sizes, spacing, etc.)
         ============================================ -->
    <style>
        /* ==========================================
           RESET STYLES
           Removes default browser spacing so we start clean
           ========================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ==========================================
           MAIN PAGE BACKGROUND & LAYOUT
           Sets the blue gradient background and basic page structure
           ========================================== */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 80px;
        }

        /* ==========================================
           CONTAINER
           Centers content and sets max width for readability
           ========================================== */
        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        /* ==========================================
           PAGE TITLE (‚õ≥ Golf Course Tracker)
           Styles the main heading at the top
           ========================================== */
        /* ==========================================
           TOP HEADER BAR
           Title on the left, user info on the right
           ========================================== */
        .top-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .title-animation-area {
            flex: 1;
            min-width: 0;
        }

        .putt-animation {
            width: 100%;
            max-width: 380px;
            height: 62px;
        }

        /* Putter swing - gentle pendulum like a real putt */
        .putter-swing {
            animation: putterStroke 1.0s ease-in-out forwards;
        }
        @keyframes putterStroke {
            0%   { transform: rotate(6deg); }
            30%  { transform: rotate(6deg); }
            55%  { transform: rotate(-3deg); }
            75%  { transform: rotate(-5deg); }
            100% { transform: rotate(-3deg); }
        }

        /* Ball rolls smoothly under text, gradually decelerating, then curves up to period */
        .rolling-ball {
            animation: ballRollPath 3s linear 0.55s forwards;
        }
        @keyframes ballRollPath {
            0%   { transform: translate(0px, 0px); opacity: 1; }
            5%   { transform: translate(22px, 0px); opacity: 1; }
            10%  { transform: translate(44px, 0px); opacity: 1; }
            15%  { transform: translate(65px, 0px); opacity: 1; }
            20%  { transform: translate(85px, 0px); opacity: 1; }
            25%  { transform: translate(104px, 0px); opacity: 1; }
            30%  { transform: translate(122px, 0px); opacity: 1; }
            35%  { transform: translate(139px, 0px); opacity: 1; }
            40%  { transform: translate(155px, 0px); opacity: 1; }
            45%  { transform: translate(170px, 0px); opacity: 1; }
            50%  { transform: translate(184px, 0px); opacity: 1; }
            55%  { transform: translate(197px, 0px); opacity: 1; }
            60%  { transform: translate(209px, 0px); opacity: 1; }
            65%  { transform: translate(220px, 0px); opacity: 1; }
            70%  { transform: translate(230px, 0px); opacity: 1; }
            75%  { transform: translate(239px, 0px); opacity: 1; }
            80%  { transform: translate(247px, 0px); opacity: 1; }
            85%  { transform: translate(254px, 0px); opacity: 1; }
            90%  { transform: translate(260px, 0px); opacity: 1; }
            93%  { transform: translate(265px, 0px); opacity: 1; }
            96%  { transform: translate(268px, -3px); opacity: 1; }
            100% { transform: translate(269px, -8px); opacity: 0; }
        }

        /* The period dot fades in exactly where the ball ends */
        .end-dot {
            animation: dotAppear 0.2s ease-in 3.45s forwards;
        }
        @keyframes dotAppear {
            0%   { opacity: 0; }
            100% { opacity: 1; }
        }

        h1 {
            color: white;
            font-size: 22px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            margin: 0;
            white-space: nowrap;
        }

        .user-bar-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ==========================================
           VIEW TOGGLE BUTTONS (My Courses / Add Course)
           The two buttons that switch between list view and add form
           ========================================== */
        .view-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .view-toggle button {
            flex: 1;
            padding: 12px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        /* Active button style (the one currently selected) */
        .view-toggle button.active {
            background: white;
            color: #1e3c72;
            font-weight: 600;
        }

        /* ==========================================
           CARD COMPONENT
           White rounded boxes that contain forms and content
           ========================================== */
        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        /* ==========================================
           FORM INPUT STYLES
           All text inputs, dropdowns, and text areas
           ========================================== */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        input[type="text"],
        input[type="email"],
        input[type="password"],
        textarea,
        select,
        input[type="date"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        /* ==========================================
           AUTOCOMPLETE DROPDOWN STYLES
           Dropdown that appears when typing course names
           ========================================== */
        .autocomplete-container {
            position: relative;
            width: 100%;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #2a5298;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
        }

        .autocomplete-dropdown.active {
            display: block;
        }

        .autocomplete-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.2s;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover {
            background: #f5f9ff;
        }

        .autocomplete-item-name {
            font-weight: 600;
            color: #1e3c72;
            margin-bottom: 4px;
        }

        .autocomplete-item-location {
            font-size: 13px;
            color: #666;
        }

        .autocomplete-loading {
            padding: 12px;
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        .autocomplete-no-results {
            padding: 12px;
            text-align: center;
            color: #999;
            font-size: 14px;
        }

        /* When user clicks into an input field, highlight it with blue border */
        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus,
        textarea:focus,
        select:focus,
        input[type="date"]:focus {
            outline: none;
            border-color: #2a5298;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* ==========================================
           RATING SYSTEM STYLES
           The three clickable rating options (Must Play, Would Like, If Nearby)
           ========================================== */
        .rating-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .rating-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        /* Hover effect when mouse moves over a rating option */
        .rating-option:hover {
            border-color: #2a5298;
            background: #f5f9ff;
        }

        .rating-option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        /* When a rating is selected, highlight it */
        .rating-option.selected {
            border-color: #2a5298;
            background: #f5f9ff;
        }

        .rating-label {
            flex: 1;
        }

        .rating-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
        }

        .rating-desc {
            font-size: 13px;
            color: #666;
        }

        /* ==========================================
           BUTTON STYLES
           Primary buttons (blue) and secondary buttons (gray)
           ========================================== */
        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #2a5298;
            color: white;
        }

        /* Hover effect - button lifts up slightly and changes color */
        .btn-primary:hover {
            background: #1e3c72;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(42, 82, 152, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            margin-top: 10px;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        /* ==========================================
           COURSE LIST STYLES
           The list of all golf courses you've added
           ========================================== */
        .course-list {
            display: none;
        }

        /* Only show when "active" class is added */
        .course-list.active {
            display: block;
        }

        /* Individual course item in the list */
        .course-item {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
        }

        /* When hovering over a course, lift it up */
        .course-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .course-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .course-name {
            font-size: 18px;
            font-weight: 700;
            color: #1e3c72;
            flex: 1;
        }

        /* ==========================================
           RATING BADGES
           Colored badges showing course rating (Must Play, Would Like, If Nearby)
           ========================================== */
        .course-rating {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
            margin-left: 10px;
        }

        /* Red badge for "Must Play" courses */
        .rating-must {
            background: #dc3545;
            color: white;
        }

        /* Yellow badge for "Would Like" courses */
        .rating-would {
            background: #ffc107;
            color: #333;
        }

        /* Green badge for "If Nearby" courses */
        .rating-nearby {
            background: #28a745;
            color: white;
        }

        /* Badge showing how many times you've played a course */
        .times-played-badge {
            background: #6c757d;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 6px;
        }

        /* ==========================================
           COURSE DETAILS (location, source info)
           Text shown under course name in the list
           ========================================== */
        .course-location {
            color: #666;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .course-source {
            color: #999;
            font-size: 13px;
            font-style: italic;
        }

        /* Clickable map pin links */
        .map-link {
            text-decoration: none;
            display: block;
            cursor: pointer;
            transition: color 0.2s;
        }
        .map-link:hover {
            color: #2a5298 !important;
            text-decoration: underline;
        }

        /* Website link in wishlist card */
        .course-website-link {
            display: block;
            color: #2a5298;
            font-size: 12px;
            text-decoration: none;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 200px;
            transition: color 0.2s;
        }
        .course-website-link:hover {
            color: #1e3c72;
            text-decoration: underline;
        }

        /* Golf Digest Ranking Badge */
        .gd-ranking {
            text-align: center;
            background: linear-gradient(135deg, #0b5e1f, #1a8a3a);
            color: white;
            border-radius: 8px;
            padding: 6px 10px;
            min-width: 70px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }
        .gd-ranking-label {
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.85;
            font-weight: 600;
        }
        .gd-ranking-number {
            font-size: 22px;
            font-weight: 800;
            line-height: 1.1;
        }
        .gd-ranking-list {
            font-size: 8px;
            text-transform: uppercase;
            opacity: 0.75;
            letter-spacing: 0.3px;
            margin-top: 1px;
        }

        /* ==========================================
           EMPTY STATE
           What shows when you haven't added any courses yet
           ========================================== */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        /* ==========================================
           COURSE DETAIL MODAL (Popup)
           The popup window that shows when you click a course
           ========================================== */
        .course-detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }

        /* Show modal when "active" class is added */
        .course-detail-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 24px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        /* X button to close the modal */
        .modal-close {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .detail-section {
            margin-bottom: 20px;
        }

        .detail-label {
            font-weight: 600;
            color: #666;
            font-size: 13px;
            text-transform: uppercase;
            margin-bottom: 6px;
        }

        .detail-value {
            color: #333;
            font-size: 16px;
        }

        /* Red delete button */
        .btn-delete {
            background: #dc3545;
            color: white;
        }

        .btn-delete:hover {
            background: #c82333;
        }

        /* ==========================================
           UTILITY STYLES
           Small helper styles used in various places
           ========================================== */
        .loading {
            display: inline-block;
            margin-left: 8px;
            opacity: 0.6;
        }

        #addForm {
            display: none;
        }

        #addForm.active {
            display: block;
        }

        .address-lookup {
            font-size: 13px;
            color: #666;
            margin-top: 4px;
        }

        /* ==========================================
           LOADING SCREEN
           Shown briefly while Firebase checks auth state
           ========================================== */
        #loadingScreen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
            color: white;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 16px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ==========================================
           AUTH SCREEN (Login / Sign Up / Reset)
           ========================================== */
        #authScreen { display: none; }
        .auth-card {
            background: white;
            border-radius: 16px;
            padding: 32px 28px;
            max-width: 440px;
            margin: 0 auto;
            box-shadow: 0 12px 40px rgba(0,0,0,0.25);
        }
        .auth-card h2 { color: #1e3c72; text-align: center; margin-bottom: 8px; font-size: 22px; }
        .auth-subtitle { text-align: center; color: #666; font-size: 14px; margin-bottom: 24px; }
        .auth-error {
            background: #fff3f3; border: 1px solid #ffcccc; color: #cc0000;
            padding: 10px 14px; border-radius: 8px; font-size: 14px;
            margin-bottom: 16px; display: none;
        }
        .auth-success {
            background: #f0fff4; border: 1px solid #c6f6d5; color: #276749;
            padding: 10px 14px; border-radius: 8px; font-size: 14px;
            margin-bottom: 16px; display: none;
        }
        .auth-link { text-align: center; margin-top: 16px; font-size: 14px; color: #666; }
        .auth-link a { color: #2a5298; text-decoration: none; font-weight: 600; cursor: pointer; }
        .auth-link a:hover { text-decoration: underline; }
        .auth-divider { display: flex; align-items: center; margin: 20px 0; color: #999; font-size: 13px; }
        .auth-divider::before, .auth-divider::after { content: ''; flex: 1; border-bottom: 1px solid #e0e0e0; }
        .auth-divider::before { margin-right: 12px; }
        .auth-divider::after { margin-left: 12px; }

        /* ==========================================
           USER BAR (shows who's logged in)
           ========================================== */
        .user-bar-email {
            color: rgba(255,255,255,0.85); font-size: 12px;
            overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
            max-width: 120px;
        }
        .btn-logout {
            background: rgba(255,255,255,0.2); color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 5px 10px; border-radius: 6px; font-size: 12px;
            cursor: pointer; transition: all 0.3s; font-weight: 500;
        }
        .btn-logout:hover { background: rgba(255,255,255,0.35); }

        /* Main app hidden by default until login */
        #mainApp { display: none; }

        /* Golf Quote Banner */
        .golf-quote {
            color: rgba(255,255,255,0.85);
            font-style: italic;
            font-size: 14px;
            text-align: center;
            padding: 0px 16px;
            margin-bottom: 8px;
            margin-top: -10px;
            line-height: 1.5;
        }
        .golf-quote-author {
            font-style: normal;
            font-weight: 600;
            font-size: 12px;
            color: rgba(255,255,255,0.6);
            margin-top: 4px;
        }

        /* Disabled button style */
        .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none !important; }

        /* ==========================================
           PLAYER CHIPS
           Individual person badges in the "Played With" section
           ========================================== */
        .player-chip {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f0f4ff;
            border: 1px solid #c8d6f0;
            border-radius: 8px;
            padding: 10px 12px;
            margin-bottom: 8px;
        }
        .player-chip-info {
            flex: 1;
        }
        .player-chip-name {
            font-weight: 600;
            color: #1e3c72;
            font-size: 15px;
        }
        .player-chip-detail {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }
        .player-chip-remove {
            background: none;
            border: none;
            color: #cc0000;
            font-size: 20px;
            cursor: pointer;
            padding: 0 0 0 12px;
            line-height: 1;
        }
        .player-chip-remove:hover {
            color: #ff0000;
        }

        /* ==========================================
           PHOTO THUMBNAILS
           Preview images in the form and detail modal
           ========================================== */
        .photo-thumb-container {
            position: relative;
            display: inline-block;
        }
        .photo-thumb {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: border-color 0.2s;
        }
        .photo-thumb:hover {
            border-color: #2a5298;
        }
        .photo-thumb-remove {
            position: absolute;
            top: -6px;
            right: -6px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        .photo-thumb-remove:hover {
            background: #c82333;
        }
        /* Full-size photo viewer overlay */
        .photo-viewer {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .photo-viewer.active {
            display: flex;
        }
        .photo-viewer img {
            max-width: 95%;
            max-height: 95%;
            border-radius: 8px;
        }
        /* Detail modal photo grid */
        .detail-photos {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .detail-photo {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: border-color 0.2s;
        }
        .detail-photo:hover {
            border-color: #2a5298;
        }

        /* Photo thumbnails in the played list cards */
        .list-photo-strip {
            display: flex;
            gap: 6px;
            margin-top: 10px;
            align-items: center;
        }
        .list-photo-thumb {
            width: 56px;
            height: 56px;
            object-fit: cover;
            border-radius: 6px;
            border: 2px solid #e0e0e0;
        }
        .list-photo-more {
            width: 56px;
            height: 56px;
            border-radius: 6px;
            background: #f0f0f0;
            border: 2px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 600;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- ============================================
         MAIN CONTAINER
         Everything inside here is centered on the page
         ============================================ -->
    <div class="container">
        <!-- Top header bar: title on left, user info on right -->
        <div class="top-header">
            <div class="title-animation-area">
                <svg class="putt-animation" id="puttSvg" viewBox="0 0 400 62" xmlns="http://www.w3.org/2000/svg">
                    <!-- Golfer in putting stance ‚Äî proper bent-over posture -->
                    <g class="golfer-group" transform="translate(18, -12)">
                        <!-- Back foot (planted, slightly angled) -->
                        <polygon points="-6,56 -3,56 -1,58 -7,58" fill="#2c2c2c"/>
                        <!-- Front foot -->
                        <polygon points="6,56 9,56 11,58 5,58" fill="#2c2c2c"/>
                        
                        <!-- Back leg (pants - khaki) -->
                        <line x1="0" y1="38" x2="-3" y2="56" stroke="#c4a96a" stroke-width="3.5" stroke-linecap="round"/>
                        <!-- Front leg -->
                        <line x1="2" y1="38" x2="7" y2="56" stroke="#c4a96a" stroke-width="3.5" stroke-linecap="round"/>
                        
                        <!-- Torso (polo shirt - dark blue) ‚Äî bent well forward -->
                        <line x1="1" y1="38" x2="6" y2="22" stroke="#1a3a6b" stroke-width="4.5" stroke-linecap="round"/>
                        
                        <!-- Head (skin tone) -->
                        <circle cx="9" cy="14" r="4" fill="#f0c8a0"/>
                        
                        <!-- Hat (red cap) -->
                        <ellipse cx="10" cy="11.5" rx="5.5" ry="2.5" fill="#cc2222"/>
                        <!-- Hat brim -->
                        <line x1="6" y1="12.5" x2="16" y2="11" stroke="#cc2222" stroke-width="1.5" stroke-linecap="round"/>
                        
                        <!-- Back arm (upper) -->
                        <line x1="5" y1="24" x2="9" y2="30" stroke="#1a3a6b" stroke-width="2.5" stroke-linecap="round"/>
                        <!-- Back arm (forearm - skin) -->
                        <line x1="9" y1="30" x2="13" y2="36" stroke="#f0c8a0" stroke-width="2.2" stroke-linecap="round"/>
                        
                        <!-- Front arm (upper) -->
                        <line x1="6" y1="23" x2="10" y2="29" stroke="#1a3a6b" stroke-width="2.5" stroke-linecap="round"/>
                        <!-- Front arm (forearm - skin) -->
                        <line x1="10" y1="29" x2="13" y2="36" stroke="#f0c8a0" stroke-width="2.2" stroke-linecap="round"/>
                        
                        <!-- Hands (gloves) -->
                        <circle cx="13" cy="36" r="1.8" fill="#eee"/>
                        
                        <!-- Putter (swings from hands) -->
                        <g class="putter-swing" transform-origin="13 36">
                            <!-- Putter shaft (silver) -->
                            <line x1="13" y1="36" x2="15" y2="54" stroke="#ccc" stroke-width="1.3" stroke-linecap="round"/>
                            <!-- Putter head (darker) -->
                            <rect x="13" y="53" width="6" height="2" rx="0.8" fill="#999"/>
                        </g>
                    </g>

                    <!-- Title text -->
                    <text id="titleText" x="46" y="36" fill="white" font-family="inherit" font-weight="bold" font-size="22">Golf Course Tracker</text>

                    <!-- Golf ball ‚Äî rolls below text then curves up to become period -->
                    <circle class="rolling-ball" cx="36" cy="42" r="2.2" fill="white"/>

                    <!-- The period dot ‚Äî positioned by JS right after text ends -->
                    <circle class="end-dot" id="endDot" cx="280" cy="34" r="2.2" fill="white" opacity="0"/>
                </svg>
            </div>
            <div id="userBarArea" class="user-bar-right" style="display: none;">
                <div class="user-bar-email" id="userBarEmail"></div>
                <button class="btn-logout" id="btnLogout">Sign Out</button>
            </div>
        </div>

        <!-- Position the end dot precisely after the text -->
        <script>
        (function() {
            try {
                var txt = document.getElementById('titleText');
                var dot = document.getElementById('endDot');
                if (txt && dot) {
                    var bbox = txt.getBBox();
                    var dotX = bbox.x + bbox.width + 4;
                    var dotY = bbox.y + bbox.height - 4;
                    dot.setAttribute('cx', dotX);
                    dot.setAttribute('cy', dotY);
                    // Calculate ball travel distance (ball starts at cx=36, cy=42)
                    var totalX = dotX - 36;
                    var totalY = -(42 - dotY);
                    // Update the keyframes dynamically using transform
                    var sheets = document.styleSheets;
                    for (var i = 0; i < sheets.length; i++) {
                        try {
                            var rules = sheets[i].cssRules;
                            for (var j = 0; j < rules.length; j++) {
                                if (rules[j].name === 'ballRollPath') {
                                    sheets[i].deleteRule(j);
                                    sheets[i].insertRule(
                                        '@keyframes ballRollPath {' +
                                        '0%   { transform: translate(0px, 0px); opacity: 1; }' +
                                        '5%   { transform: translate(' + (totalX * 0.08) + 'px, 0px); opacity: 1; }' +
                                        '10%  { transform: translate(' + (totalX * 0.16) + 'px, 0px); opacity: 1; }' +
                                        '15%  { transform: translate(' + (totalX * 0.24) + 'px, 0px); opacity: 1; }' +
                                        '20%  { transform: translate(' + (totalX * 0.32) + 'px, 0px); opacity: 1; }' +
                                        '25%  { transform: translate(' + (totalX * 0.39) + 'px, 0px); opacity: 1; }' +
                                        '30%  { transform: translate(' + (totalX * 0.46) + 'px, 0px); opacity: 1; }' +
                                        '35%  { transform: translate(' + (totalX * 0.52) + 'px, 0px); opacity: 1; }' +
                                        '40%  { transform: translate(' + (totalX * 0.58) + 'px, 0px); opacity: 1; }' +
                                        '45%  { transform: translate(' + (totalX * 0.63) + 'px, 0px); opacity: 1; }' +
                                        '50%  { transform: translate(' + (totalX * 0.68) + 'px, 0px); opacity: 1; }' +
                                        '55%  { transform: translate(' + (totalX * 0.73) + 'px, 0px); opacity: 1; }' +
                                        '60%  { transform: translate(' + (totalX * 0.77) + 'px, 0px); opacity: 1; }' +
                                        '65%  { transform: translate(' + (totalX * 0.81) + 'px, 0px); opacity: 1; }' +
                                        '70%  { transform: translate(' + (totalX * 0.85) + 'px, 0px); opacity: 1; }' +
                                        '75%  { transform: translate(' + (totalX * 0.89) + 'px, 0px); opacity: 1; }' +
                                        '80%  { transform: translate(' + (totalX * 0.92) + 'px, 0px); opacity: 1; }' +
                                        '85%  { transform: translate(' + (totalX * 0.94) + 'px, 0px); opacity: 1; }' +
                                        '90%  { transform: translate(' + (totalX * 0.96) + 'px, 0px); opacity: 1; }' +
                                        '93%  { transform: translate(' + (totalX * 0.98) + 'px, 0px); opacity: 1; }' +
                                        '96%  { transform: translate(' + (totalX * 0.99) + 'px, ' + (totalY * 0.4) + 'px); opacity: 1; }' +
                                        '100% { transform: translate(' + totalX + 'px, ' + totalY + 'px); opacity: 0; }' +
                                        '}', j
                                    );
                                    break;
                                }
                            }
                        } catch(e) {}
                    }
                }
            } catch(e) { console.log('Animation positioning skipped'); }
        })();
        </script>

        <!-- ============================================
             LOADING SCREEN
             Shown while Firebase checks if you're already logged in
             ============================================ -->
        <div id="loadingScreen">
            <div class="loading-spinner"></div>
            <div>Loading...</div>
        </div>

        <!-- ============================================
             AUTH SCREEN (Login / Sign Up / Reset Password)
             Only shows when NOT logged in
             ============================================ -->
        <div id="authScreen">
            <!-- LOGIN FORM -->
            <div id="loginView" class="auth-card">
                <h2>Welcome Back</h2>
                <p class="auth-subtitle">Sign in to access your courses</p>
                <div id="loginError" class="auth-error"></div>
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="you@example.com" autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Your password" autocomplete="current-password">
                </div>
                <button id="btnLogin" class="btn btn-primary">Sign In</button>
                <div class="auth-link" style="margin-top: 12px;"><a id="linkForgotPassword">Forgot password?</a></div>
                <div class="auth-divider">or</div>
                <div class="auth-link">Don't have an account? <a id="linkShowSignup">Sign Up</a></div>
            </div>

            <!-- SIGN UP FORM -->
            <div id="signupView" class="auth-card" style="display: none;">
                <h2>Create Account</h2>
                <p class="auth-subtitle">Start tracking your golf courses</p>
                <div id="signupError" class="auth-error"></div>
                <div class="form-group">
                    <label for="signupName">Display Name</label>
                    <input type="text" id="signupName" placeholder="Your name" autocomplete="name">
                </div>
                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" placeholder="you@example.com" autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" placeholder="At least 6 characters" autocomplete="new-password">
                </div>
                <div class="form-group">
                    <label for="signupConfirm">Confirm Password</label>
                    <input type="password" id="signupConfirm" placeholder="Re-enter password" autocomplete="new-password">
                </div>
                <button id="btnSignup" class="btn btn-primary">Create Account</button>
                <div class="auth-divider">or</div>
                <div class="auth-link">Already have an account? <a id="linkShowLogin">Sign In</a></div>
            </div>

            <!-- FORGOT PASSWORD FORM -->
            <div id="resetView" class="auth-card" style="display: none;">
                <h2>Reset Password</h2>
                <p class="auth-subtitle">We'll send you a link to reset your password</p>
                <div id="resetError" class="auth-error"></div>
                <div id="resetSuccess" class="auth-success"></div>
                <div class="form-group">
                    <label for="resetEmail">Email</label>
                    <input type="email" id="resetEmail" placeholder="you@example.com" autocomplete="email">
                </div>
                <button id="btnReset" class="btn btn-primary">Send Reset Link</button>
                <div class="auth-link" style="margin-top: 16px;"><a id="linkBackToLogin">‚Üê Back to Sign In</a></div>
            </div>
        </div>

        <!-- ============================================
             MAIN APP (only visible after login)
             ============================================ -->
        <div id="mainApp">

            <!-- Golf Quote Banner -->
            <div id="golfQuote" class="golf-quote"></div>

        <!-- ============================================
             VIEW TOGGLE BUTTONS
             Three buttons to switch between Wish List, Played List, and Add Course
             ============================================ -->
        <div class="view-toggle">
            <button id="btnShowWishList" class="active">Wish List</button>
            <button id="btnShowPlayedList">Played</button>
            <button id="btnShowAdd">Add</button>
        </div>

        <!-- ============================================
             ADD COURSE FORM
             This form is hidden by default. Shows when you click "Add"
             Has different fields depending on Wish List vs Played
             ============================================ -->
        <div id="addForm" class="card">
            <h2 style="margin-bottom: 20px; color: #1e3c72;">Add Course</h2>
            
            <form id="courseForm">
                <!-- Choose between Wish List or Played -->
                <div class="form-group">
                    <label>Add to:</label>
                    <div class="rating-options">
                        <label class="rating-option list-type-option">
                            <input type="radio" name="listType" value="wishlist" checked>
                            <div class="rating-label">
                                <div class="rating-title">‚≠ê Wish List</div>
                                <div class="rating-desc">Courses you want to play</div>
                            </div>
                        </label>
                        <label class="rating-option list-type-option">
                            <input type="radio" name="listType" value="played">
                            <div class="rating-label">
                                <div class="rating-title">‚úÖ Played</div>
                                <div class="rating-desc">Courses you've already played</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Course Name Input (Required) -->
                <div class="form-group">
                    <label for="courseName">Course Name *</label>
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px;">
                        <div class="autocomplete-container">
                            <input type="text" id="courseName" required placeholder="e.g., Pebble Beach Golf Links" autocomplete="off">
                            <div class="autocomplete-dropdown" id="autocompleteDropdown"></div>
                        </div>
                        <button type="button" id="btnRefreshInfo" class="btn btn-secondary" style="margin: 0; padding: 12px 16px; font-size: 14px; white-space: nowrap;" title="Refresh address and website info">üîÑ Refresh</button>
                    </div>
                    <!-- This div shows "Looking up address..." or "Address found" messages -->
                    <div class="address-lookup" id="addressLookupStatus"></div>
                </div>

                <!-- ============================================
                     SHARED LOCATION FIELDS (for both Wishlist and Played)
                     ============================================ -->
                <!-- Address Input (Auto-filled by looking up the course name) -->
                <div class="form-group">
                    <label for="address">Address</label>
                    <input type="text" id="address" placeholder="Will auto-fill or you can enter manually">
                </div>

                <!-- City Input -->
                <div class="form-group">
                    <label for="city">City</label>
                    <input type="text" id="city" placeholder="e.g., Pebble Beach">
                </div>

                <!-- State Input -->
                <div class="form-group">
                    <label for="state">State</label>
                    <input type="text" id="state" placeholder="e.g., California">
                </div>

                <!-- Country Input -->
                <div class="form-group">
                    <label for="country">Country</label>
                    <input type="text" id="country" placeholder="e.g., USA">
                </div>

                <!-- Course Website -->
                <div class="form-group">
                    <label for="website">Course Website</label>
                    <input type="text" id="website" placeholder="Will auto-fill or you can enter manually">
                </div>

                <!-- ============================================
                     WISH LIST FIELDS
                     Only shown when "Wish List" is selected
                     ============================================ -->
                <div id="wishlistFields">
                    <!-- Where You Heard About It (Optional) -->
                    <div class="form-group">
                        <label for="heardFrom">Where did you hear about it?</label>
                        <input type="text" id="heardFrom" placeholder="e.g., Friend, Magazine, YouTube">
                    </div>

                    <!-- Rating Selection - Your 3-tier system -->
                    <div class="form-group">
                        <label>Rating</label>
                        <div class="rating-options">
                            <!-- Option 1: Must Play -->
                            <label class="rating-option">
                                <input type="radio" name="rating" value="must">
                                <div class="rating-label">
                                    <div class="rating-title">üåü Must Play</div>
                                    <div class="rating-desc">Would make a special trip</div>
                                </div>
                            </label>
                            <!-- Option 2: Would Like to Play -->
                            <label class="rating-option">
                                <input type="radio" name="rating" value="would">
                                <div class="rating-label">
                                    <div class="rating-title">‚≠ê Would Like to Play</div>
                                    <div class="rating-desc">If convenient</div>
                                </div>
                            </label>
                            <!-- Option 3: Would Play if Nearby -->
                            <label class="rating-option">
                                <input type="radio" name="rating" value="nearby">
                                <div class="rating-label">
                                    <div class="rating-title">‚ú® Would Play if Nearby</div>
                                    <div class="rating-desc">If in the same city</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Notes Section (Optional) -->
                    <div class="form-group">
                        <label for="wishlistNotes">Notes</label>
                        <textarea id="wishlistNotes" placeholder="Any additional thoughts or details..."></textarea>
                    </div>
                </div>

                <!-- ============================================
                     PLAYED FIELDS
                     Only shown when "Played" is selected
                     ============================================ -->
                <div id="playedFields" style="display: none;">
                    <!-- Date Played (Required for played courses) -->
                    <div class="form-group">
                        <label for="datePlayed">Date *</label>
                        <input type="date" id="datePlayed">
                    </div>

                    <!-- 9 or 18 Holes -->
                    <div class="form-group">
                        <label>Holes Played</label>
                        <div class="rating-options">
                            <label class="rating-option">
                                <input type="radio" name="holes" value="9">
                                <div class="rating-label">
                                    <div class="rating-title">9 Holes</div>
                                </div>
                            </label>
                            <label class="rating-option">
                                <input type="radio" name="holes" value="18" checked>
                                <div class="rating-label">
                                    <div class="rating-title">18 Holes</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Score -->
                    <div class="form-group">
                        <label for="score">Score</label>
                        <input type="text" id="score" placeholder="e.g., 85, 92">
                    </div>

                    <!-- Who You Played With - Add one person at a time -->
                    <div class="form-group">
                        <label>People Played With</label>
                        <!-- List of added players (starts empty) -->
                        <div id="playersList" style="margin-bottom: 10px;"></div>
                        <!-- Input fields to add one person -->
                        <div id="playerInputArea" style="background: #f8f9fa; border-radius: 8px; padding: 12px; border: 2px solid #e0e0e0;">
                            <div style="margin-bottom: 8px;">
                                <div class="autocomplete-container">
                                    <input type="text" id="playerName" placeholder="Name *" style="margin-bottom: 8px;" autocomplete="off">
                                    <div class="autocomplete-dropdown" id="playerAutocompleteDropdown"></div>
                                </div>
                                <input type="text" id="playerCompany" placeholder="Company (optional)" style="margin-bottom: 8px;">
                                <input type="text" id="playerEmail" placeholder="Email (optional)">
                            </div>
                            <button type="button" id="btnAddPlayer" class="btn btn-primary" style="padding: 10px; font-size: 14px;">+ Add Person</button>
                        </div>
                    </div>

                    <!-- Notes for Played -->
                    <div class="form-group">
                        <label for="playedNotes">Notes</label>
                        <textarea id="playedNotes" placeholder="How was the experience? Any memorable moments?"></textarea>
                    </div>

                    <!-- Photos -->
                    <div class="form-group">
                        <label>Photos</label>
                        <!-- Preview area for added photos -->
                        <div id="photosPreview" style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px;"></div>
                        <!-- File input - on iPhone this opens Photos app, on PC opens file browser -->
                        <label class="btn btn-secondary" style="text-align: center; display: block; cursor: pointer; margin-top: 0;">
                            üì∑ Add Photos
                            <input type="file" id="photoInput" accept="image/*" multiple style="display: none;">
                        </label>
                        <div style="font-size: 12px; color: #999; margin-top: 6px;">You can add multiple photos. Photos are automatically compressed.</div>
                    </div>
                </div>

                <!-- Submit, Cancel, and Delete Buttons -->
                <button type="submit" id="btnSubmitCourse" class="btn btn-primary">Add Course</button>
                <button type="button" id="btnCancelAdd" class="btn btn-secondary">Cancel</button>
                <button type="button" id="btnDeleteFromForm" class="btn btn-delete" style="display: none; margin-top: 10px;">üóëÔ∏è Delete Course</button>
            </form>
        </div>

        <!-- ============================================
             WISH LIST VIEW
             Shows all courses you want to play
             ============================================ -->
        <div id="wishList" class="course-list active">
            <!-- JavaScript will insert your wish list courses here dynamically -->
        </div>

        <!-- ============================================
             PLAYED LIST VIEW
             Shows all courses you've played (can have duplicates)
             ============================================ -->
        <div id="playedList" class="course-list">
            <!-- JavaScript will insert your played courses here dynamically -->
        </div>

        <!-- ============================================
             COURSE DETAIL MODAL (POPUP)
             Hidden popup that shows when you click on a course
             Displays all details and has a delete button
             ============================================ -->
        <div id="courseModal" class="course-detail-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <!-- Course name will be inserted here by JavaScript -->
                    <h2 id="modalCourseName" style="color: #1e3c72; flex: 1;"></h2>
                    <!-- X button to close the popup -->
                    <button class="modal-close" id="btnCloseModal">&times;</button>
                </div>
                
                <!-- All course details will be inserted here by JavaScript -->
                <div id="modalContent">
                    <!-- Details will be inserted here -->
                </div>
                
                <!-- Buttons shown based on which list you're viewing -->
                <div id="modalButtons">
                    <!-- "Mark as Played" button (only for wish list courses) -->
                    <button id="btnMarkAsPlayed" class="btn btn-primary" style="display: none; margin-bottom: 10px;">‚úÖ Mark as Played</button>
                    <!-- Edit button -->
                    <button id="btnEditCourse" class="btn btn-primary" style="margin-top: 24px; margin-bottom: 10px;">‚úèÔ∏è Edit</button>
                    <!-- Delete button (red) -->
                    <button id="btnDeleteCourse" class="btn btn-delete">Delete Course</button>
                </div>
            </div>
        </div>
        </div><!-- end mainApp -->

        <!-- Full-size photo viewer (click a thumbnail to see it big) -->
        <div id="photoViewer" class="photo-viewer" onclick="this.classList.remove('active');">
            <img id="photoViewerImg" src="" alt="Photo">
        </div>
    </div>

    <!-- ============================================
         JAVASCRIPT CODE
         This is where all the app logic lives - making buttons work,
         saving data, showing/hiding things, etc.
         ============================================ -->
    <script>
        console.log('JavaScript is loading...');
        
        // ==========================================
        // FIREBASE CONFIGURATION & INITIALIZATION
        //
        // *** ONE-TIME SETUP REQUIRED ***
        // You need to enable Email/Password sign-in in Firebase.
        // Follow the step-by-step instructions below.
        //
        // Already done: Realtime Database + security rules
        // Still needed: Enable Email/Password auth (see instructions below)
        // ==========================================
        const firebaseConfig = {
            apiKey: "AIzaSyDifFA4lfZyuq83mZLisCPQLO2iISzrb8I",
            authDomain: "golf-tracker-abbf1.firebaseapp.com",
            databaseURL: "https://golf-tracker-abbf1-default-rtdb.firebaseio.com",
            projectId: "golf-tracker-abbf1",
            storageBucket: "golf-tracker-abbf1.firebasestorage.app",
            messagingSenderId: "347480815517",
            appId: "1:347480815517:web:821e0055e59fe8f6cb6174",
            measurementId: "G-M1Q2HGQWG2"
        };
        
        // Initialize Firebase
        let database;
        let currentUserId = null;
        let useCloudSync = false;
        let firebaseListeners = [];  // Track listeners so we can detach on logout
        
        try {
            firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            console.log('Firebase initialized');
        } catch (error) {
            console.error('Firebase initialization error:', error);
        }

        // ==========================================
        // AUTH STATE LISTENER
        // This is the HEART of the login system.
        // Firebase calls this automatically whenever:
        //   - The page first loads (checks if already logged in)
        //   - A user logs in
        //   - A user logs out
        // It controls which screen is shown.
        // ==========================================
        firebase.auth().onAuthStateChanged(function(user) {
            document.getElementById('loadingScreen').style.display = 'none';
            
            if (user) {
                // USER IS LOGGED IN
                currentUserId = user.uid;
                useCloudSync = true;
                console.log('User signed in:', user.email, 'UID:', user.uid);
                
                document.getElementById('userBarEmail').textContent = 
                    'üë§ ' + (user.displayName || user.email);
                
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('userBarArea').style.display = 'flex';
                
                loadDataFromCloud();
                displayRandomGolfQuote();
            } else {
                // USER IS NOT LOGGED IN
                currentUserId = null;
                useCloudSync = false;
                console.log('No user signed in');
                
                document.getElementById('authScreen').style.display = 'block';
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('userBarArea').style.display = 'none';
                
                wishlistCourses = [];
                playedCourses = [];
                savedPlayers = [];
                renderWishList();
                renderPlayedList();
                
                // Detach Firebase listeners
                firebaseListeners.forEach(function(ref) { ref.off(); });
                firebaseListeners = [];
            }
        });

        // ==========================================
        // GOLF QUOTES
        // A random quote displays each time you load the app
        // ==========================================
        const golfQuotes = [
            { text: "The most important shot in golf is the next one.", author: "Ben Hogan" },
            { text: "Golf is deceptively simple and endlessly complicated.", author: "Arnold Palmer" },
            { text: "Success in golf depends less on strength of body than upon strength of mind and character.", author: "Arnold Palmer" },
            { text: "Golf is the closest game to the game we call life.", author: "Bobby Jones" },
            { text: "I never learned anything from a match that I won.", author: "Bobby Jones" },
            { text: "The secret of golf is to turn three shots into two.", author: "Bobby Jones" },
            { text: "Concentrate on hitting the green. The hole will come to you.", author: "Cary Middlecoff" },
            { text: "I know I am getting better at golf because I am hitting fewer spectators.", author: "Gerald Ford" },
            { text: "They say golf is like life, but don't believe them. Golf is more complicated than that.", author: "Gardner Dickinson" },
            { text: "Golf is a game in which you yell fore, shoot six, and write down five.", author: "Paul Harvey" },
            { text: "The only thing a golfer needs is more daylight.", author: "Ben Hogan" },
            { text: "I play in the low 80s. If it's any hotter than that, I won't play.", author: "Joe E. Lewis" },
            { text: "Golf is a game whose aim is to hit a very small ball into an even smaller hole, with weapons singularly ill-designed for the purpose.", author: "Winston Churchill" },
            { text: "Give me golf clubs, fresh air, and a beautiful partner, and you can keep the clubs and the fresh air.", author: "Jack Benny" },
            { text: "If you are caught on a golf course during a storm and are afraid of lightning, hold up a 1-iron. Not even God can hit a 1-iron.", author: "Lee Trevino" },
            { text: "I'm hitting the woods just great, but I'm having a terrible time getting out of them.", author: "Harry Toscano" },
            { text: "Golf is a puzzle without an answer.", author: "Gary Player" },
            { text: "The more I practice, the luckier I get.", author: "Gary Player" },
            { text: "Eighteen holes of match play will teach you more about your foe than 18 years of dealing with him across a desk.", author: "Grantland Rice" },
            { text: "A bad day of golf is better than a good day of work.", author: "Unknown" },
            { text: "Golf is the only sport where the most feared opponent is you.", author: "Unknown" },
            { text: "Every golfer has a little voice inside their head. Mine usually says the wrong thing.", author: "Lee Trevino" },
            { text: "One of the most fascinating things about golf is how it reflects the cycle of life.", author: "Tom Watson" },
            { text: "Swing easy, hit hard.", author: "Julius Boros" },
            { text: "It's good sportsmanship to not pick up lost golf balls while they are still rolling.", author: "Mark Twain" },
            { text: "Golf is about how well you accept, adjust, and score with your misses much more so than it is about your perfect shots.", author: "Tommy Armour" },
            { text: "The only way to enjoy golf is to be a good sport about losing.", author: "Unknown" },
            { text: "Don't play too much golf. Two rounds a day are plenty.", author: "Harry Vardon" },
            { text: "Half of golf is fun; the other half is putting.", author: "Peter Dobereiner" },
            { text: "It took me seventeen years to get 3,000 hits in baseball. It took one afternoon on the golf course.", author: "Hank Aaron" },
            { text: "Golf combines two favorite American pastimes: taking long walks and hitting things with a stick.", author: "P.J. O'Rourke" },
            { text: "You can make a lot of money in this game. Just ask my ex-wives. Both of them are so rich that neither of their husbands work.", author: "Lee Trevino" },
            { text: "May thy ball lie in green pastures, and not in still waters.", author: "Ben Hogan" },
            { text: "The ardent golfer would play Mount Everest if somebody would put a flag stick on top.", author: "Pete Dye" },
            { text: "There is no similarity between golf and putting; they are two different games, one played in the air, and the other on the ground.", author: "Ben Hogan" },
            { text: "You don't know what pressure is until you play for five bucks with only two in your pocket.", author: "Lee Trevino" },
            { text: "Golf is a game that is played on a five-inch course ‚Äî the distance between your ears.", author: "Bobby Jones" },
            { text: "The golf swing is like a suitcase into which we are trying to pack one too many things.", author: "John Updike" },
            { text: "I have a tip that can take five strokes off anyone's golf game: it's called an eraser.", author: "Arnold Palmer" },
            { text: "After all these years, it's still embarrassing for me to play on the American golf tour. Like the time I asked my caddie for a sand wedge and he came back ten minutes later with a ham on rye.", author: "Chi-Chi Rodriguez" }
        ];

        function displayRandomGolfQuote() {
            const quote = golfQuotes[Math.floor(Math.random() * golfQuotes.length)];
            document.getElementById('golfQuote').innerHTML = 
                '"' + quote.text + '"' +
                '<div class="golf-quote-author">‚Äî ' + quote.author + '</div>';
        }

        // ==========================================
        // AUTH SCREEN NAVIGATION
        // ==========================================
        document.getElementById('linkShowSignup').addEventListener('click', function() {
            document.getElementById('loginView').style.display = 'none';
            document.getElementById('signupView').style.display = 'block';
            document.getElementById('resetView').style.display = 'none';
            clearAuthErrors();
        });
        document.getElementById('linkShowLogin').addEventListener('click', function() {
            document.getElementById('loginView').style.display = 'block';
            document.getElementById('signupView').style.display = 'none';
            document.getElementById('resetView').style.display = 'none';
            clearAuthErrors();
        });
        document.getElementById('linkForgotPassword').addEventListener('click', function() {
            document.getElementById('loginView').style.display = 'none';
            document.getElementById('signupView').style.display = 'none';
            document.getElementById('resetView').style.display = 'block';
            document.getElementById('resetEmail').value = document.getElementById('loginEmail').value;
            clearAuthErrors();
        });
        document.getElementById('linkBackToLogin').addEventListener('click', function() {
            document.getElementById('loginView').style.display = 'block';
            document.getElementById('signupView').style.display = 'none';
            document.getElementById('resetView').style.display = 'none';
            clearAuthErrors();
        });

        function clearAuthErrors() {
            ['loginError','signupError','resetError','resetSuccess'].forEach(function(id) {
                document.getElementById(id).style.display = 'none';
            });
        }
        function showAuthError(id, msg) {
            var el = document.getElementById(id);
            el.textContent = msg;
            el.style.display = 'block';
        }
        function friendlyAuthError(error) {
            switch (error.code) {
                case 'auth/user-not-found': return 'No account found with this email. Would you like to sign up?';
                case 'auth/wrong-password':
                case 'auth/invalid-credential': return 'Incorrect password. Please try again or reset your password.';
                case 'auth/email-already-in-use': return 'An account with this email already exists. Try signing in instead.';
                case 'auth/weak-password': return 'Password must be at least 6 characters.';
                case 'auth/invalid-email': return 'Please enter a valid email address.';
                case 'auth/too-many-requests': return 'Too many attempts. Please wait a moment and try again.';
                case 'auth/network-request-failed': return 'Network error. Please check your internet connection.';
                default: return error.message || 'Something went wrong. Please try again.';
            }
        }

        // LOGIN
        document.getElementById('btnLogin').addEventListener('click', async function() {
            var email = document.getElementById('loginEmail').value.trim();
            var password = document.getElementById('loginPassword').value;
            if (!email || !password) { showAuthError('loginError', 'Please enter your email and password.'); return; }
            this.disabled = true; this.textContent = 'Signing in...'; clearAuthErrors();
            try { await firebase.auth().signInWithEmailAndPassword(email, password); }
            catch (error) { showAuthError('loginError', friendlyAuthError(error)); }
            finally { this.disabled = false; this.textContent = 'Sign In'; }
        });
        document.getElementById('loginPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') document.getElementById('btnLogin').click();
        });
        document.getElementById('loginEmail').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') document.getElementById('loginPassword').focus();
        });

        // SIGN UP
        document.getElementById('btnSignup').addEventListener('click', async function() {
            var name = document.getElementById('signupName').value.trim();
            var email = document.getElementById('signupEmail').value.trim();
            var password = document.getElementById('signupPassword').value;
            var confirm = document.getElementById('signupConfirm').value;
            if (!email || !password) { showAuthError('signupError', 'Please enter your email and password.'); return; }
            if (password !== confirm) { showAuthError('signupError', 'Passwords do not match.'); return; }
            if (password.length < 6) { showAuthError('signupError', 'Password must be at least 6 characters.'); return; }
            this.disabled = true; this.textContent = 'Creating account...'; clearAuthErrors();
            try {
                var cred = await firebase.auth().createUserWithEmailAndPassword(email, password);
                if (name) {
                    await cred.user.updateProfile({ displayName: name });
                    document.getElementById('userBarEmail').textContent = 'üë§ ' + name;
                }
            } catch (error) { showAuthError('signupError', friendlyAuthError(error)); }
            finally { this.disabled = false; this.textContent = 'Create Account'; }
        });
        document.getElementById('signupConfirm').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') document.getElementById('btnSignup').click();
        });

        // PASSWORD RESET
        document.getElementById('btnReset').addEventListener('click', async function() {
            var email = document.getElementById('resetEmail').value.trim();
            if (!email) { showAuthError('resetError', 'Please enter your email address.'); return; }
            this.disabled = true; this.textContent = 'Sending...'; clearAuthErrors();
            try {
                await firebase.auth().sendPasswordResetEmail(email);
                var el = document.getElementById('resetSuccess');
                el.textContent = 'Password reset email sent! Check your inbox (and spam folder).';
                el.style.display = 'block';
            } catch (error) { showAuthError('resetError', friendlyAuthError(error)); }
            finally { this.disabled = false; this.textContent = 'Send Reset Link'; }
        });

        // SIGN OUT
        document.getElementById('btnLogout').addEventListener('click', function() {
            firebase.auth().signOut().catch(function(err) { console.error('Sign out error:', err); });
        });
        
        // ==========================================
        // DATA STORAGE VARIABLES
        // Two separate arrays: one for wish list, one for played courses
        // ==========================================
        let wishlistCourses = [];  // Courses you want to play
        let playedCourses = [];    // Courses you've played (can have duplicates)
        let savedPlayers = [];     // Directory of people you've played with (synced to cloud)
        let currentCourseId = null;  // Keeps track of which course popup is open
        let currentListType = null;  // Tracks whether we're viewing 'wishlist' or 'played'
        let editingId = null;        // ID of course/round being edited (null = adding new)
        let editingType = null;      // 'wishlist' or 'played' when editing

        // localStorage fallback removed - now using Firebase email/password auth only

        // ==========================================
        // LOAD DATA FROM FIREBASE CLOUD
        // Syncs data across all your devices
        // ==========================================
        function loadDataFromCloud() {
            if (!useCloudSync || !currentUserId || !database) return;
            
            var userRef = database.ref('users/' + currentUserId);
            
            var wishlistRef = userRef.child('wishlist');
            wishlistRef.on('value', function(snapshot) {
                var data = snapshot.val();
                wishlistCourses = data ? Object.values(data) : [];
                renderWishList();
            });
            firebaseListeners.push(wishlistRef);
            
            var playedRef = userRef.child('played');
            playedRef.on('value', function(snapshot) {
                var data = snapshot.val();
                playedCourses = data ? Object.values(data) : [];
                renderPlayedList();
            });
            firebaseListeners.push(playedRef);
            
            // Load saved players directory
            var playersRef = userRef.child('savedPlayers');
            playersRef.on('value', function(snapshot) {
                var data = snapshot.val();
                savedPlayers = data ? Object.values(data) : [];
            });
            firebaseListeners.push(playersRef);
        }

        // ==========================================
        // SAVE DATA TO CLOUD (and Local Storage as backup)
        // Whenever you add/delete a course, save to cloud
        // ==========================================
        function saveData() {
            if (useCloudSync && currentUserId && database) {
                const userRef = database.ref('users/' + currentUserId);
                
                // Convert arrays to objects with IDs as keys for Firebase
                const wishlistObj = {};
                wishlistCourses.forEach(course => {
                    wishlistObj[course.id] = course;
                });
                
                const playedObj = {};
                playedCourses.forEach(round => {
                    playedObj[round.id] = round;
                });
                
                // Save to cloud
                userRef.child('wishlist').set(wishlistObj)
                    .catch(error => console.error('Error saving wishlist to cloud:', error));
                    
                userRef.child('played').set(playedObj)
                    .catch(error => console.error('Error saving played to cloud:', error));
                
                // Save players directory
                const playersObj = {};
                savedPlayers.forEach(function(player) {
                    // Use a sanitized version of the name as the key
                    const key = player.name.toLowerCase().replace(/[^a-z0-9]/g, '_');
                    playersObj[key] = player;
                });
                userRef.child('savedPlayers').set(playersObj)
                    .catch(error => console.error('Error saving players to cloud:', error));
            }
        }

        // ==========================================
        // AUTOCOMPLETE FUNCTIONALITY
        // Searches for golf courses as you type
        // ==========================================
        let autocompleteTimeout = null;
        const courseNameInput = document.getElementById('courseName');
        const autocompleteDropdown = document.getElementById('autocompleteDropdown');

        // ==========================================
        // COMPREHENSIVE LOCAL GOLF COURSE DATABASE
        // Provides instant results without waiting for API
        // ==========================================
        const localCourseDatabase = [
            // Pinehurst Resort
            { name: 'Pinehurst No. 1', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 2', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 3', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 4', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 5', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 6', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 8', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 9', location: 'Pinehurst, NC' },
            { name: 'Pinehurst No. 10 - The Cradle', location: 'Pinehurst, NC' },
            { name: 'The Cradle at Pinehurst', location: 'Pinehurst, NC' },
            
            // Pebble Beach Resorts
            { name: 'Pebble Beach Golf Links', location: 'Pebble Beach, CA' },
            { name: 'Spyglass Hill Golf Course', location: 'Pebble Beach, CA' },
            { name: 'The Links at Spanish Bay', location: 'Pebble Beach, CA' },
            { name: 'Del Monte Golf Course', location: 'Monterey, CA' },
            { name: 'Poppy Hills Golf Course', location: 'Pebble Beach, CA' },
            
            // Torrey Pines
            { name: 'Torrey Pines North Course', location: 'La Jolla, CA' },
            { name: 'Torrey Pines South Course', location: 'San Diego, CA' },
            
            // Atlanta Area
            { name: 'Bobby Jones Golf Course', location: 'Atlanta, GA' },
            { name: 'Ansley Golf Club', location: 'Atlanta, GA' },
            { name: 'Ansley Golf Club - Settindown Creek', location: 'Roswell, GA' },
            { name: 'East Lake Golf Club', location: 'Atlanta, GA' },
            { name: 'Peachtree Golf Club', location: 'Atlanta, GA' },
            { name: 'Atlanta Athletic Club - Highlands', location: 'Johns Creek, GA' },
            { name: 'Atlanta Athletic Club - Riverside', location: 'Johns Creek, GA' },
            { name: 'Cherokee Town and Country Club', location: 'Atlanta, GA' },
            
            // Bandon Dunes
            { name: 'Bandon Dunes', location: 'Bandon, OR' },
            { name: 'Pacific Dunes', location: 'Bandon, OR' },
            { name: 'Bandon Trails', location: 'Bandon, OR' },
            { name: 'Old Macdonald', location: 'Bandon, OR' },
            { name: 'Sheep Ranch', location: 'Bandon, OR' },
            { name: 'Bandon Preserve', location: 'Bandon, OR' },
            
            // Bethpage
            { name: 'Bethpage Black Course', location: 'Farmingdale, NY' },
            { name: 'Bethpage Red Course', location: 'Farmingdale, NY' },
            { name: 'Bethpage Blue Course', location: 'Farmingdale, NY' },
            { name: 'Bethpage Green Course', location: 'Farmingdale, NY' },
            { name: 'Bethpage Yellow Course', location: 'Farmingdale, NY' },
            
            // Streamsong
            { name: 'Streamsong Red', location: 'Bowling Green, FL' },
            { name: 'Streamsong Blue', location: 'Bowling Green, FL' },
            { name: 'Streamsong Black', location: 'Bowling Green, FL' },
            
            // Major Championship Courses
            { name: 'Augusta National Golf Club', location: 'Augusta, GA' },
            { name: 'Oakmont Country Club', location: 'Oakmont, PA' },
            { name: 'Shinnecock Hills Golf Club', location: 'Southampton, NY' },
            { name: 'Merion Golf Club', location: 'Ardmore, PA' },
            { name: 'Winged Foot Golf Club', location: 'Mamaroneck, NY' },
            { name: 'Olympic Club', location: 'San Francisco, CA' },
            { name: 'Baltusrol Golf Club', location: 'Springfield, NJ' },
            
            // TPC Courses
            { name: 'TPC Sawgrass - Stadium Course', location: 'Ponte Vedra Beach, FL' },
            { name: 'TPC Scottsdale - Stadium Course', location: 'Scottsdale, AZ' },
            
            // Other Notable US Courses
            { name: 'Kiawah Island Ocean Course', location: 'Kiawah Island, SC' },
            { name: 'Chambers Bay', location: 'University Place, WA' },
            { name: 'Whistling Straits', location: 'Kohler, WI' },
            { name: 'Shadow Creek', location: 'Las Vegas, NV' },
            { name: 'Pine Valley Golf Club', location: 'Pine Valley, NJ' },
            { name: 'Cypress Point Club', location: 'Pebble Beach, CA' },
            { name: 'Sand Hills Golf Club', location: 'Mullen, NE' },
            { name: 'Riviera Country Club', location: 'Pacific Palisades, CA' },
            
            // Scotland
            { name: 'St Andrews Old Course', location: 'St Andrews, Scotland' },
            { name: 'St Andrews New Course', location: 'St Andrews, Scotland' },
            { name: 'Royal Dornoch', location: 'Dornoch, Scotland' },
            { name: 'Carnoustie Golf Links', location: 'Carnoustie, Scotland' },
            { name: 'Muirfield', location: 'Gullane, Scotland' },
            { name: 'Royal Troon', location: 'Troon, Scotland' },
            { name: 'Turnberry', location: 'Turnberry, Scotland' },
            
            // Ireland
            { name: 'Royal County Down', location: 'Newcastle, Northern Ireland' },
            { name: 'Ballybunion Golf Club', location: 'Ballybunion, Ireland' },
            { name: 'Lahinch Golf Club', location: 'Lahinch, Ireland' },
            { name: 'Portmarnock Golf Club', location: 'Portmarnock, Ireland' },
            { name: 'Royal Portrush', location: 'Portrush, Northern Ireland' },
            
            // International
            { name: 'Royal Melbourne', location: 'Melbourne, Australia' },
            { name: 'Kingston Heath Golf Club', location: 'Melbourne, Australia' },
            { name: 'Cape Kidnappers', location: 'Hawke\'s Bay, New Zealand' },
            { name: 'Kauri Cliffs', location: 'Matauri Bay, New Zealand' },

            // Additional well-known courses
            { name: 'Ridgewood Country Club', location: 'Paramus, New Jersey' },
            { name: 'The Ridgewood Golf Club', location: 'Paramus, New Jersey' },
            { name: 'Ansley Golf Club', location: 'Atlanta, Georgia' },
            { name: 'East Lake Golf Club', location: 'Atlanta, Georgia' },
            { name: 'Atlanta Athletic Club', location: 'Johns Creek, Georgia' },
            { name: 'Peachtree Golf Club', location: 'Atlanta, Georgia' },
            { name: 'Capital City Club', location: 'Atlanta, Georgia' },
            { name: 'Bobby Jones Golf Course', location: 'Atlanta, Georgia' },
            { name: 'TPC Sugarloaf', location: 'Duluth, Georgia' },
            { name: 'The Manor Golf Club', location: 'Milton, Georgia' },
            { name: 'Hawks Ridge Golf Club', location: 'Ball Ground, Georgia' },
            { name: 'Ch√¢teau √âlan Golf Club', location: 'Braselton, Georgia' },
            { name: 'Reynolds Lake Oconee', location: 'Greensboro, Georgia' },
            { name: 'Sea Island Golf Club', location: 'St. Simons Island, Georgia' },
            { name: 'The Landings Club', location: 'Savannah, Georgia' },
            { name: 'Torrey Pines Golf Course', location: 'La Jolla, California' },
            { name: 'Spyglass Hill Golf Course', location: 'Pebble Beach, California' },
            { name: 'The Links at Spanish Bay', location: 'Pebble Beach, California' },
            { name: 'Pasatiempo Golf Club', location: 'Santa Cruz, California' },
            { name: 'Pelican Hill Golf Club', location: 'Newport Coast, California' },
            { name: 'Trump National Golf Club', location: 'Rancho Palos Verdes, California' },
            { name: 'Trump International Golf Club', location: 'West Palm Beach, Florida' },
            { name: 'Trump National Doral', location: 'Miami, Florida' },
            { name: 'Harding Park Golf Course', location: 'San Francisco, California' },
            { name: 'Poppy Hills Golf Course', location: 'Pebble Beach, California' },
            { name: 'We-Ko-Pa Golf Club', location: 'Scottsdale, Arizona' },
            { name: 'Troon North Golf Club', location: 'Scottsdale, Arizona' },
            { name: 'TPC Scottsdale', location: 'Scottsdale, Arizona' },
            { name: 'Grayhawk Golf Club', location: 'Scottsdale, Arizona' },
            { name: 'Quintero Golf Club', location: 'Peoria, Arizona' },
            { name: 'Bay Hill Club & Lodge', location: 'Orlando, Florida' },
            { name: 'Arnold Palmer\'s Bay Hill', location: 'Orlando, Florida' },
            { name: 'Innisbrook Resort', location: 'Palm Harbor, Florida' },
            { name: 'Sawgrass Marriott Golf Resort', location: 'Ponte Vedra Beach, Florida' },
            { name: 'World Golf Village', location: 'St. Augustine, Florida' },
            { name: 'PGA National Resort', location: 'Palm Beach Gardens, Florida' },
            { name: 'Doral Golf Resort', location: 'Miami, Florida' },
            { name: 'Boca Raton Resort & Club', location: 'Boca Raton, Florida' },
            { name: 'Jupiter Hills Club', location: 'Tequesta, Florida' },
            { name: 'Seminole Golf Club', location: 'Juno Beach, Florida' },
            { name: 'The Breakers', location: 'Palm Beach, Florida' },
            { name: 'Calusa Pines Golf Club', location: 'Naples, Florida' },
            { name: 'Old Marsh Golf Club', location: 'Palm Beach Gardens, Florida' },
            { name: 'Medalist Golf Club', location: 'Hobe Sound, Florida' },
            { name: 'The Bear\'s Club', location: 'Jupiter, Florida' },
            { name: 'Pine Tree Golf Club', location: 'Boynton Beach, Florida' },
            { name: 'Loxahatchee Club', location: 'Jupiter, Florida' },
            { name: 'McArthur Golf Club', location: 'Hobe Sound, Florida' },
            { name: 'Harbour Town Golf Links', location: 'Hilton Head Island, South Carolina' },
            { name: 'Kiawah Island Golf Resort', location: 'Kiawah Island, South Carolina' },
            { name: 'Cabot Saint Lucia', location: 'Point Hardy, Saint Lucia' },
            { name: 'Cabot Citrus Farms', location: 'Brooksville, Florida' },
            { name: 'Barnbougle Dunes', location: 'Bridport, Tasmania, Australia' },
            { name: 'Royal County Down', location: 'Newcastle, Northern Ireland' },
            { name: 'Royal Dornoch', location: 'Dornoch, Scotland' },
            { name: 'Turnberry', location: 'Turnberry, Scotland' },
            { name: 'Carnoustie Golf Links', location: 'Carnoustie, Scotland' },
            { name: 'Royal Troon Golf Club', location: 'Troon, Scotland' },
            { name: 'Muirfield', location: 'Gullane, Scotland' },
            { name: 'Trump Turnberry', location: 'Turnberry, Scotland' },
            { name: 'Trump Aberdeen', location: 'Balmedie, Scotland' },
            { name: 'Kingsbarns Golf Links', location: 'St Andrews, Scotland' },
            { name: 'North Berwick Golf Club', location: 'North Berwick, Scotland' },
            { name: 'Cruden Bay Golf Club', location: 'Cruden Bay, Scotland' },
            { name: 'Royal Birkdale Golf Club', location: 'Southport, England' },
            { name: 'Sunningdale Golf Club', location: 'Sunningdale, England' },
            { name: 'Wentworth Club', location: 'Virginia Water, England' },
            { name: 'The Grove', location: 'Chandler\'s Cross, England' },
            { name: 'Ballybunion Golf Club', location: 'Ballybunion, Ireland' },
            { name: 'Lahinch Golf Club', location: 'Lahinch, Ireland' },
            { name: 'Old Head Golf Links', location: 'Kinsale, Ireland' },
            { name: 'Portmarnock Golf Club', location: 'Dublin, Ireland' },
            { name: 'Waterville Golf Links', location: 'Waterville, Ireland' },
            { name: 'Doonbeg Golf Club', location: 'Doonbeg, Ireland' },
            { name: 'Trump International Doonbeg', location: 'Doonbeg, Ireland' },
            { name: 'Emirates Golf Club', location: 'Dubai, UAE' },
            { name: 'Jumeirah Golf Estates', location: 'Dubai, UAE' },
            { name: 'Yas Links', location: 'Abu Dhabi, UAE' },
            { name: 'Saadiyat Beach Golf Club', location: 'Abu Dhabi, UAE' },
            { name: 'Al Hamra Golf Club', location: 'Ras Al Khaimah, UAE' },
            { name: 'Tower Links Golf Club', location: 'Ras Al Khaimah, UAE' },
            { name: 'Jebel Ali Golf Resort', location: 'Dubai, UAE' },
            { name: 'Dubai Creek Golf & Yacht Club', location: 'Dubai, UAE' },
            { name: 'The Els Club', location: 'Dubai, UAE' },
            { name: 'Al Ain Equestrian Golf Club', location: 'Al Ain, UAE' },
            { name: 'Abu Dhabi Golf Club', location: 'Abu Dhabi, UAE' },
            { name: 'Winged Foot Golf Club', location: 'Mamaroneck, New York' },
            { name: 'Garden City Golf Club', location: 'Garden City, New York' },
            { name: 'Friar\'s Head', location: 'Baiting Hollow, New York' },
            { name: 'Sebonack Golf Club', location: 'Southampton, New York' },
            { name: 'The Bridge', location: 'Bridgehampton, New York' },
            { name: 'Maidstone Club', location: 'East Hampton, New York' },
            { name: 'Quaker Ridge Golf Club', location: 'Scarsdale, New York' },
            { name: 'Deepdale Golf Club', location: 'Manhasset, New York' },
            { name: 'Piping Rock Club', location: 'Locust Valley, New York' },
            { name: 'Bethpage State Park', location: 'Farmingdale, New York' },
            { name: 'Hudson National Golf Club', location: 'Croton-on-Hudson, New York' },
            { name: 'Sleepy Hollow Country Club', location: 'Briarcliff Manor, New York' },
            { name: 'Bayonne Golf Club', location: 'Bayonne, New Jersey' },
            { name: 'Galloway National Golf Club', location: 'Galloway, New Jersey' },
            { name: 'Somerset Hills Country Club', location: 'Bernardsville, New Jersey' },
            { name: 'Plainfield Country Club', location: 'Edison, New Jersey' },
            { name: 'Hamilton Farm Golf Club', location: 'Gladstone, New Jersey' },
            { name: 'Liberty National Golf Club', location: 'Jersey City, New Jersey' },
            { name: 'The Creek', location: 'Locust Valley, New York' },
            { name: 'Congressional Country Club', location: 'Bethesda, Maryland' },
            { name: 'Aronimink Golf Club', location: 'Newtown Square, Pennsylvania' },
            { name: 'Philadelphia Cricket Club', location: 'Flourtown, Pennsylvania' },
            { name: 'Myopia Hunt Club', location: 'South Hamilton, Massachusetts' },
            { name: 'Essex County Club', location: 'Manchester-by-the-Sea, Massachusetts' },
            { name: 'Eastward Ho! Country Club', location: 'Chatham, Massachusetts' },
            { name: 'Kittansett Club', location: 'Marion, Massachusetts' },
            { name: 'Boston Golf Club', location: 'Hingham, Massachusetts' },
            { name: 'Salem Country Club', location: 'Peabody, Massachusetts' },
            { name: 'The Country Club', location: 'Brookline, Massachusetts' },
            { name: 'Newport Country Club', location: 'Newport, Rhode Island' },
            { name: 'Wannamoisett Country Club', location: 'Rumford, Rhode Island' },
            { name: 'Yale Golf Course', location: 'New Haven, Connecticut' },
            { name: 'The Stanwich Club', location: 'Greenwich, Connecticut' },
            { name: 'Shelter Harbor Golf Club', location: 'Charlestown, Rhode Island' }
        ];

        // ==========================================
        // FAST LOCAL SEARCH WITH API FALLBACK
        // ==========================================
        
        // Function to search for golf courses - LOCAL FIRST, then Photon API
        function searchGolfCourses(query) {
            if (query.length < 2) {
                autocompleteDropdown.classList.remove('active');
                return;
            }

            // INSTANT LOCAL SEARCH
            const queryLower = query.toLowerCase().trim();
            
            const localResults = localCourseDatabase.filter(course => {
                const courseName = course.name.toLowerCase();
                // Fuzzy partial match - check if query is a substring OR if words match
                if (courseName.includes(queryLower)) return true;
                // Check if all query words appear somewhere in the course name (partial word match)
                const queryWords = queryLower.split(/\s+/);
                return queryWords.every(word => 
                    courseName.split(/\s+/).some(cw => cw.startsWith(word))
                );
            }).slice(0, 8);

            // Show local results immediately
            if (localResults.length > 0) {
                displayResults(localResults, query.length >= 3);
            }
            
            // Always also search Photon API if 3+ chars for additional results
            if (query.length >= 3) {
                if (!localResults.length) {
                    autocompleteDropdown.innerHTML = '<div class="autocomplete-loading">Searching...</div>';
                    autocompleteDropdown.classList.add('active');
                }
                searchWithPhotonAPI(query, localResults);
            } else if (!localResults.length) {
                autocompleteDropdown.innerHTML = '<div class="autocomplete-no-results">Keep typing to search...</div>';
                autocompleteDropdown.classList.add('active');
            }
        }

        // Photon API - fast, free geocoding with partial match support
        async function searchWithPhotonAPI(query, existingLocalResults) {
            try {
                const response = await fetch(
                    `https://photon.komoot.io/api/?q=${encodeURIComponent(query + ' golf')}&limit=15&lang=en`
                );
                
                if (!response.ok) throw new Error('Photon search failed');
                
                const data = await response.json();
                
                const results = data.features
                    .filter(f => {
                        const name = (f.properties.name || '').toLowerCase();
                        const type = (f.properties.osm_value || '').toLowerCase();
                        // Keep results that are golf-related
                        return name.includes('golf') || type.includes('golf') || 
                               name.includes(query.toLowerCase().split(' ')[0]);
                    })
                    .map(f => {
                        const p = f.properties;
                        const city = p.city || p.county || p.town || p.village || '';
                        const state = p.state || '';
                        const country = p.country || '';
                        let location = '';
                        if (city && state && country !== 'United States') {
                            location = city + ', ' + country;
                        } else if (city && state) {
                            location = city + ', ' + state;
                        } else if (state && country) {
                            location = state + ', ' + country;
                        } else {
                            location = country;
                        }
                        return {
                            name: p.name || query,
                            location: location
                        };
                    })
                    .slice(0, 8);
                
                // Merge with local results, removing duplicates
                const existingNames = new Set(existingLocalResults.map(r => r.name.toLowerCase()));
                const newResults = results.filter(r => !existingNames.has(r.name.toLowerCase()));
                const combined = [...existingLocalResults, ...newResults].slice(0, 10);
                
                if (combined.length > 0) {
                    displayResults(combined, false);
                } else {
                    // Last resort: try Nominatim
                    searchWithOpenStreetMap(query);
                }
                
            } catch (error) {
                console.error('Photon search error:', error);
                // Fall back to Nominatim
                if (!existingLocalResults.length) {
                    searchWithOpenStreetMap(query);
                }
            }
        }

        // Fast OpenStreetMap search (faster than Google Places)
        async function searchWithOpenStreetMap(query) {
            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?` +
                    `q=${encodeURIComponent(query + ' golf course')}&` +
                    `format=json&` +
                    `limit=10&` +
                    `addressdetails=1`,
                    {
                        headers: {
                            'User-Agent': 'GolfCourseTracker/1.0'
                        }
                    }
                );

                if (!response.ok) {
                    throw new Error('Search failed');
                }

                const data = await response.json();
                
                const results = data
                    .filter(place => {
                        const name = place.display_name.toLowerCase();
                        return name.includes('golf');
                    })
                    .map(place => {
                        const parts = place.display_name.split(',');
                        let courseName = parts[0].trim();
                        
                        let location = '';
                        if (place.address) {
                            const city = place.address.city || place.address.town || place.address.village || '';
                            const state = place.address.state || '';
                            const country = place.address.country || '';
                            
                            if (city && state) {
                                location = `${city}, ${state}`;
                            } else if (city && country) {
                                location = `${city}, ${country}`;
                            } else if (state && country) {
                                location = `${state}, ${country}`;
                            } else {
                                location = country || parts.slice(-2).join(', ').trim();
                            }
                        } else {
                            location = parts.slice(-2).join(', ').trim();
                        }
                        
                        return {
                            name: courseName,
                            location: location
                        };
                    })
                    .slice(0, 10);

                displayResults(results);
                
            } catch (error) {
                console.error('OpenStreetMap search error:', error);
                autocompleteDropdown.innerHTML = '<div class="autocomplete-no-results">Search unavailable. Please enter course name manually.</div>';
            }
        }

        // Google API search (kept as backup but not actively used due to speed)
        function searchWithGoogleAPI(query) {
            if (!autocompleteService) {
                searchWithOpenStreetMap(query);
                return;
            }

            try {
                const request = {
                    input: query + ' golf course',
                    types: ['establishment']
                };

                autocompleteService.getPlacePredictions(request, (predictions, status) => {
                    if (status !== google.maps.places.PlacesServiceStatus.OK || !predictions) {
                        // Fallback to OpenStreetMap
                        searchWithOpenStreetMap(query);
                        return;
                    }

                    const results = predictions
                        .filter(prediction => {
                            const desc = prediction.description.toLowerCase();
                            return desc.includes('golf');
                        })
                        .slice(0, 10)
                        .map(prediction => {
                            const name = prediction.structured_formatting.main_text;
                            const location = prediction.structured_formatting.secondary_text || '';
                            return { name, location };
                        });

                    displayResults(results);
                });
            } catch (error) {
                console.error('Google API error:', error);
                searchWithOpenStreetMap(query);
            }
        }

        // Display search results
        function displayResults(results, stillSearching) {
            if (results.length === 0) {
                autocompleteDropdown.innerHTML = '<div class="autocomplete-no-results">No courses found. Please try a different search.</div>';
            } else {
                autocompleteDropdown.classList.add('active');
                autocompleteDropdown.innerHTML = results.map(course => `
                    <div class="autocomplete-item" data-name="${escapeHtml(course.name)}" data-location="${escapeHtml(course.location)}">
                        <div class="autocomplete-item-name">${escapeHtml(course.name)}</div>
                        <div class="autocomplete-item-location">${escapeHtml(course.location)}</div>
                    </div>
                `).join('') + (stillSearching ? '<div class="autocomplete-loading" style="font-size:11px; padding:6px 12px;">Searching for more courses...</div>' : '');

                // Add click handlers to each result
                document.querySelectorAll('.autocomplete-item').forEach(item => {
                    item.addEventListener('click', async function() {
                        const courseName = this.getAttribute('data-name');
                        const location = this.getAttribute('data-location');
                        
                        courseNameInput.value = courseName;
                        
                        // Parse location string into city, state, country
                        // Location format is typically "City, State" or "City, Country"
                        if (location) {
                            const parts = location.split(',').map(p => p.trim());
                            
                            // Fill city
                            const cityInput = document.getElementById('city');
                            if (cityInput && parts.length > 0) {
                                cityInput.value = parts[0];
                            }
                            
                            // Fill state
                            const stateInput = document.getElementById('state');
                            if (stateInput && parts.length > 1) {
                                stateInput.value = parts[1];
                            }
                            
                            // Fill country - default to USA if it looks like a US state
                            const countryInput = document.getElementById('country');
                            if (countryInput) {
                                if (parts.length > 1) {
                                    // Check if second part is a US state (2 letters)
                                    if (parts[1].length === 2) {
                                        countryInput.value = 'USA';
                                    } else {
                                        countryInput.value = parts[1];
                                    }
                                }
                            }
                        }
                        
                        // Auto-fill address and website by looking up the selected course
                        const statusEl = document.getElementById('addressLookupStatus');
                        statusEl.innerHTML = '<span class="loading">Looking up details...</span>';
                        
                        try {
                            // Use Photon API for structured address data
                            // Include the location from the autocomplete if available for better results
                            const locationHint = location ? ' ' + location : '';
                            const response = await fetch(
                                `https://photon.komoot.io/api/?q=${encodeURIComponent(courseName + locationHint)}&limit=5&lang=en`
                            );
                            
                            const data = await response.json();
                            
                            if (data && data.features && data.features.length > 0) {
                                // Score each result by how well it matches the course name
                                const courseNameLower = courseName.toLowerCase()
                                    .replace(/^the\s+/i, '')
                                    .replace(/[^a-z0-9\s]/g, '');
                                const courseWords = courseNameLower.split(/\s+/).filter(w => w.length > 2);
                                
                                let bestResult = null;
                                let bestScore = -1;
                                
                                for (const f of data.features) {
                                    const resultName = (f.properties.name || '').toLowerCase()
                                        .replace(/^the\s+/i, '')
                                        .replace(/[^a-z0-9\s]/g, '');
                                    const resultWords = resultName.split(/\s+/).filter(w => w.length > 2);
                                    
                                    // Count matching words
                                    let matchCount = 0;
                                    for (const cw of courseWords) {
                                        if (resultWords.some(rw => rw.includes(cw) || cw.includes(rw))) {
                                            matchCount++;
                                        }
                                    }
                                    
                                    // Score: percentage of course words matched
                                    const score = courseWords.length > 0 ? matchCount / courseWords.length : 0;
                                    
                                    // Bonus if result includes "golf"
                                    const hasGolf = resultName.includes('golf') ? 0.1 : 0;
                                    
                                    if (score + hasGolf > bestScore) {
                                        bestScore = score + hasGolf;
                                        bestResult = f;
                                    }
                                }
                                
                                // Only use the result if it's a reasonable match (at least 40% of words match)
                                if (bestResult && bestScore >= 0.4) {
                                    const p = bestResult.properties;
                                    const addressParts = [];
                                    if (p.name) addressParts.push(p.name);
                                    if (p.housenumber && p.street) addressParts.push(p.housenumber + ' ' + p.street);
                                    else if (p.street) addressParts.push(p.street);
                                    if (p.city || p.town || p.village) addressParts.push(p.city || p.town || p.village);
                                    if (p.county) addressParts.push(p.county);
                                    if (p.state) addressParts.push(p.state);
                                    if (p.postcode) addressParts.push(p.postcode);
                                    if (p.country) addressParts.push(p.country);
                                    
                                    const addressStr = addressParts.join(', ');
                                    if (addressStr) {
                                        document.getElementById('address').value = addressStr;
                                    }
                                    
                                    // Also fill city/state/country from Photon data if not already set
                                    const cityInput = document.getElementById('city');
                                    const stateInput = document.getElementById('state');
                                    const countryInput = document.getElementById('country');
                                    if (cityInput && !cityInput.value && (p.city || p.town || p.village)) {
                                        cityInput.value = p.city || p.town || p.village;
                                    }
                                    if (stateInput && !stateInput.value && p.state) {
                                        stateInput.value = p.state;
                                    }
                                    if (countryInput && !countryInput.value && p.country) {
                                        countryInput.value = p.country;
                                    }
                                    
                                    statusEl.innerHTML = '‚úì Details found';
                                    setTimeout(() => statusEl.textContent = '', 3000);
                                } else {
                                // Fallback to Nominatim
                                try {
                                    const nomResponse = await fetch(
                                        `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(courseName + ' golf course')}&limit=1`,
                                        { headers: { 'User-Agent': 'GolfCourseTracker/1.0' } }
                                    );
                                    const nomData = await nomResponse.json();
                                    if (nomData && nomData.length > 0) {
                                        document.getElementById('address').value = nomData[0].display_name;
                                        statusEl.innerHTML = '‚úì Address found';
                                        setTimeout(() => statusEl.textContent = '', 3000);
                                    } else {
                                        statusEl.textContent = '';
                                    }
                                } catch (e) { statusEl.textContent = ''; }
                            }
                        } catch (error) {
                            statusEl.textContent = '';
                        }
                        
                        // Smart website auto-fill: Try official website, then Wikipedia, then leave blank
                        const websiteInput = document.getElementById('website');
                        if (websiteInput && !websiteInput.value) {
                            await findCourseWebsite(courseName, websiteInput);
                        }
                        
                        autocompleteDropdown.classList.remove('active');
                    });
                });
            }
        }

        // Function to intelligently find course website
        // Strategy: 
        //   1. Try DuckDuckGo instant answer API
        //   2. Try Wikipedia for official website link
        //   3. Try Nominatim with extratags (has website data for some courses)
        //   4. Try smart domain guessing with common golf club URL patterns
        //   5. If nothing works, leave blank for manual entry
        async function findCourseWebsite(courseName, websiteInput) {
            try {
                // Step 1: DuckDuckGo Instant Answer API
                try {
                    const ddgResponse = await fetch(
                        'https://api.duckduckgo.com/?q=' + encodeURIComponent(courseName + ' golf club official site') + '&format=json&no_redirect=1'
                    );
                    const ddgData = await ddgResponse.json();
                    
                    if (ddgData.Results && ddgData.Results.length > 0) {
                        const firstUrl = ddgData.Results[0].FirstURL;
                        if (firstUrl && !firstUrl.includes('duckduckgo.com') && !firstUrl.includes('wikipedia.org')) {
                            websiteInput.value = firstUrl;
                            return;
                        }
                    }
                    
                    if (ddgData.Infobox && ddgData.Infobox.content) {
                        for (const item of ddgData.Infobox.content) {
                            if (item.label && item.label.toLowerCase() === 'website' && item.value) {
                                let url = item.value;
                                if (!url.startsWith('http')) url = 'https://' + url;
                                websiteInput.value = url;
                                return;
                            }
                        }
                    }
                    
                    if (ddgData.AbstractURL && !ddgData.AbstractURL.includes('wikipedia.org')) {
                        websiteInput.value = ddgData.AbstractURL;
                        return;
                    }
                } catch (e) {
                    console.log('DuckDuckGo lookup failed');
                }

                // Step 2: Wikipedia lookup for official website
                try {
                    const wikiQuery = encodeURIComponent(courseName);
                    const wikiResponse = await fetch(
                        'https://en.wikipedia.org/w/api.php?action=query&format=json&origin=*&prop=revisions|info&rvprop=content&rvslots=main&titles=' + wikiQuery + '&inprop=url'
                    );
                    const wikiData = await wikiResponse.json();
                    
                    if (wikiData.query && wikiData.query.pages) {
                        const pages = Object.values(wikiData.query.pages);
                        if (pages.length > 0 && pages[0].pageid) {
                            const page = pages[0];
                            if (page.revisions && page.revisions[0] && page.revisions[0].slots && page.revisions[0].slots.main) {
                                const content = page.revisions[0].slots.main['*'];
                                const websitePatterns = [
                                    /\|\s*website\s*=\s*\{?\s*(?:URL\|)?(?:\[)?(https?:\/\/[^\s\]|}]+)/i,
                                    /\|\s*url\s*=\s*\[?(https?:\/\/[^\s\]|]+)/i,
                                    /\|\s*homepage\s*=\s*\[?(https?:\/\/[^\s\]|]+)/i
                                ];
                                for (const pattern of websitePatterns) {
                                    const match = content.match(pattern);
                                    if (match) {
                                        let url = (match[1] || match[0]).replace(/^\[/, '').replace(/\]$/, '').replace(/\|.*$/, '').trim();
                                        if (url && !url.includes('facebook.com') && !url.includes('twitter.com') && 
                                            !url.includes('instagram.com') && !url.includes('youtube.com')) {
                                            websiteInput.value = url;
                                            return;
                                        }
                                    }
                                }
                            }
                        }
                    }
                } catch (e) {
                    console.log('Wikipedia lookup failed');
                }

                // Step 3: Try Nominatim with extratags (OSM sometimes has website info)
                try {
                    const nomResponse = await fetch(
                        `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(courseName + ' golf')}&limit=3&extratags=1`,
                        { headers: { 'User-Agent': 'GolfCourseTracker/1.0' } }
                    );
                    const nomData = await nomResponse.json();
                    for (const result of nomData) {
                        if (result.extratags && result.extratags.website) {
                            let url = result.extratags.website;
                            if (!url.startsWith('http')) url = 'https://' + url;
                            websiteInput.value = url;
                            return;
                        }
                        if (result.extratags && result.extratags.url) {
                            let url = result.extratags.url;
                            if (!url.startsWith('http')) url = 'https://' + url;
                            websiteInput.value = url;
                            return;
                        }
                    }
                } catch (e) {
                    console.log('Nominatim extratags lookup failed');
                }

                // Step 4: Smart domain guessing
                try {
                    // Build candidate URLs from the course name
                    const cleanName = courseName.toLowerCase()
                        .replace(/^the\s+/i, '')
                        .replace(/\s+(golf|club|course|country|resort|links|cc|gc)s?\b/gi, '')
                        .replace(/[^a-z0-9\s]/g, '')
                        .trim();
                    const words = cleanName.split(/\s+/);
                    const joined = words.join('');
                    
                    const candidates = [
                        `https://www.${joined}cc.com`,
                        `https://www.${joined}golf.com`,
                        `https://www.${joined}golfclub.com`,
                        `https://www.${joined}countryclub.com`,
                        `https://www.${joined}.com`,
                        `https://www.the${joined}.com`
                    ];
                    
                    // Try each candidate with a HEAD request
                    for (const url of candidates) {
                        try {
                            const resp = await fetch(url, { method: 'HEAD', mode: 'no-cors', signal: AbortSignal.timeout(2000) });
                            // no-cors always returns opaque, but if it doesn't throw, the domain likely exists
                            websiteInput.value = url;
                            return;
                        } catch (e) {
                            // Domain doesn't exist, try next
                        }
                    }
                } catch (e) {
                    console.log('Domain guessing failed');
                }

                // Step 5: Nothing found, leave blank
                websiteInput.value = '';
                
            } catch (error) {
                console.error('Website lookup error:', error);
                websiteInput.value = '';
            }
        }

        // Helper function to escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Listen for typing in course name field
        courseNameInput.addEventListener('input', function(e) {
            const query = e.target.value.trim();
            
            // Clear previous timeout
            if (autocompleteTimeout) {
                clearTimeout(autocompleteTimeout);
            }
            
            // Wait only 80ms after user stops typing before searching
            autocompleteTimeout = setTimeout(() => {
                searchGolfCourses(query);
            }, 80);
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.autocomplete-container')) {
                autocompleteDropdown.classList.remove('active');
            }
        });

        // Close dropdown when input loses focus (but delay to allow click on dropdown)
        courseNameInput.addEventListener('blur', function() {
            setTimeout(() => {
                autocompleteDropdown.classList.remove('active');
            }, 200);
        });

        // ==========================================
        // REFRESH INFO BUTTON
        // Manually re-fetch address and website when course name is changed
        // ==========================================
        document.getElementById('btnRefreshInfo').addEventListener('click', async function() {
            const courseName = courseNameInput.value.trim();
            
            if (!courseName || courseName.length < 3) {
                alert('Please enter a course name first');
                return;
            }
            
            const statusEl = document.getElementById('addressLookupStatus');
            statusEl.innerHTML = '<span class="loading">Looking up address and website...</span>';
            
            // Look up address
            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(courseName + ' golf course')}&limit=1`,
                    {
                        headers: {
                            'User-Agent': 'GolfCourseTracker/1.0'
                        }
                    }
                );
                
                const data = await response.json();
                
                if (data && data.length > 0) {
                    const result = data[0];
                    
                    // Fill address
                    document.getElementById('address').value = result.display_name;
                    
                    // Try to parse city, state, country from the result
                    if (result.address) {
                        const city = result.address.city || result.address.town || result.address.village || '';
                        const state = result.address.state || '';
                        const country = result.address.country || '';
                        
                        if (city) document.getElementById('city').value = city;
                        if (state) document.getElementById('state').value = state;
                        if (country) {
                            // Check if state looks like US state (2 letters)
                            if (state && state.length === 2) {
                                document.getElementById('country').value = 'USA';
                            } else {
                                document.getElementById('country').value = country;
                            }
                        }
                    }
                    
                    statusEl.innerHTML = '‚úì Address found';
                    setTimeout(() => statusEl.textContent = '', 3000);
                } else {
                    statusEl.textContent = 'No address found - please enter manually';
                    setTimeout(() => statusEl.textContent = '', 3000);
                }
            } catch (error) {
                statusEl.textContent = 'Could not lookup address';
                setTimeout(() => statusEl.textContent = '', 3000);
            }
            
            // Look up website
            const websiteInput = document.getElementById('website');
            if (websiteInput) {
                await findCourseWebsite(courseName, websiteInput);
            }
        });

        // ==========================================
        // BUTTON CLICK HANDLERS - VIEW TOGGLE
        // These make the "Wish List", "Played", and "Add" buttons work
        // ==========================================
        
        // When "Wish List" button is clicked
        document.getElementById('btnShowWishList').addEventListener('click', function() {
            document.getElementById('wishList').classList.add('active');
            document.getElementById('playedList').classList.remove('active');
            document.getElementById('addForm').classList.remove('active');
            
            this.classList.add('active');
            document.getElementById('btnShowPlayedList').classList.remove('active');
            document.getElementById('btnShowAdd').classList.remove('active');
        });

        // When "Played" button is clicked
        document.getElementById('btnShowPlayedList').addEventListener('click', function() {
            document.getElementById('playedList').classList.add('active');
            document.getElementById('wishList').classList.remove('active');
            document.getElementById('addForm').classList.remove('active');
            
            this.classList.add('active');
            document.getElementById('btnShowWishList').classList.remove('active');
            document.getElementById('btnShowAdd').classList.remove('active');
        });

        // When "Add" button is clicked
        document.getElementById('btnShowAdd').addEventListener('click', function() {
            document.getElementById('addForm').classList.add('active');
            document.getElementById('wishList').classList.remove('active');
            document.getElementById('playedList').classList.remove('active');
            
            this.classList.add('active');
            document.getElementById('btnShowWishList').classList.remove('active');
            document.getElementById('btnShowPlayedList').classList.remove('active');
        });

        // When "Cancel" button is clicked on the form
        document.getElementById('btnCancelAdd').addEventListener('click', function() {
            // Clear editing state ‚Äî original entry stays untouched
            editingId = null;
            editingType = null;
            document.getElementById('btnSubmitCourse').textContent = 'Add Course';
            document.getElementById('btnDeleteFromForm').style.display = 'none';
            
            document.getElementById('btnShowWishList').click();
            document.getElementById('courseForm').reset();
            playersArray = [];
            renderPlayersList();
            photosArray = [];
            renderPhotosPreview();
            // Reset to wishlist by default
            document.querySelector('input[name="listType"][value="wishlist"]').checked = true;
            showWishlistFields();
        });

        // ==========================================
        // TOGGLE BETWEEN WISH LIST AND PLAYED FIELDS
        // Show/hide different form fields based on selection
        // ==========================================
        document.querySelectorAll('input[name="listType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'wishlist') {
                    showWishlistFields();
                } else {
                    showPlayedFields();
                }
            });
        });

        function showWishlistFields() {
            document.getElementById('wishlistFields').style.display = 'block';
            document.getElementById('playedFields').style.display = 'none';
            // Make date NOT required for wishlist
            document.getElementById('datePlayed').removeAttribute('required');
        }

        function showPlayedFields() {
            document.getElementById('wishlistFields').style.display = 'none';
            document.getElementById('playedFields').style.display = 'block';
            // Make date required for played
            document.getElementById('datePlayed').setAttribute('required', 'required');
        }

        // ==========================================
        // PLAYERS LIST (People Played With)
        // Add one person at a time with name, company, email
        // ==========================================
        let playersArray = [];  // Stores the list of players for the current form

        function renderPlayersList() {
            const listEl = document.getElementById('playersList');
            if (playersArray.length === 0) {
                listEl.innerHTML = '';
                return;
            }
            listEl.innerHTML = playersArray.map(function(player, index) {
                let detailParts = [];
                if (player.company) detailParts.push(player.company);
                if (player.email) detailParts.push(player.email);
                const detailStr = detailParts.length > 0 ? detailParts.join(' ¬∑ ') : '';
                return '<div class="player-chip">' +
                    '<div class="player-chip-info">' +
                        '<div class="player-chip-name">' + escapeHtml(player.name) + '</div>' +
                        (detailStr ? '<div class="player-chip-detail">' + escapeHtml(detailStr) + '</div>' : '') +
                    '</div>' +
                    '<button type="button" class="player-chip-remove" data-index="' + index + '">√ó</button>' +
                '</div>';
            }).join('');

            // Add remove handlers
            listEl.querySelectorAll('.player-chip-remove').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    playersArray.splice(parseInt(this.dataset.index), 1);
                    renderPlayersList();
                });
            });
        }

        document.getElementById('btnAddPlayer').addEventListener('click', function() {
            const nameInput = document.getElementById('playerName');
            const companyInput = document.getElementById('playerCompany');
            const emailInput = document.getElementById('playerEmail');

            const name = nameInput.value.trim();
            if (!name) {
                nameInput.style.borderColor = '#dc3545';
                setTimeout(function() { nameInput.style.borderColor = '#e0e0e0'; }, 2000);
                return;
            }

            const newPlayer = {
                name: name,
                company: companyInput.value.trim(),
                email: emailInput.value.trim()
            };

            playersArray.push(newPlayer);

            // Save this player to the directory (update if already exists)
            const existingIndex = savedPlayers.findIndex(function(p) {
                return p.name.toLowerCase() === name.toLowerCase();
            });
            if (existingIndex >= 0) {
                // Update existing player's info (company/email may have changed)
                if (newPlayer.company) savedPlayers[existingIndex].company = newPlayer.company;
                if (newPlayer.email) savedPlayers[existingIndex].email = newPlayer.email;
            } else {
                savedPlayers.push(newPlayer);
            }
            saveData();  // Save the updated players directory to Firebase

            // Clear the inputs for the next person
            nameInput.value = '';
            companyInput.value = '';
            emailInput.value = '';
            nameInput.focus();

            // Close the player autocomplete dropdown
            document.getElementById('playerAutocompleteDropdown').classList.remove('active');

            renderPlayersList();
        });

        // ==========================================
        // PLAYER NAME AUTOCOMPLETE
        // Shows previously saved players as you type
        // ==========================================
        let playerAutocompleteTimeout = null;
        const playerNameInput = document.getElementById('playerName');
        const playerDropdown = document.getElementById('playerAutocompleteDropdown');

        playerNameInput.addEventListener('input', function() {
            const query = this.value.trim().toLowerCase();

            if (playerAutocompleteTimeout) clearTimeout(playerAutocompleteTimeout);

            if (query.length < 1) {
                playerDropdown.classList.remove('active');
                return;
            }

            playerAutocompleteTimeout = setTimeout(function() {
                // Filter saved players that match what's been typed
                const matches = savedPlayers.filter(function(player) {
                    return player.name.toLowerCase().includes(query);
                });

                if (matches.length === 0) {
                    playerDropdown.classList.remove('active');
                    return;
                }

                playerDropdown.classList.add('active');
                playerDropdown.innerHTML = matches.map(function(player) {
                    let detailParts = [];
                    if (player.company) detailParts.push(player.company);
                    if (player.email) detailParts.push(player.email);
                    const detailStr = detailParts.join(' ¬∑ ');
                    return '<div class="autocomplete-item player-autocomplete-item" ' +
                        'data-name="' + escapeHtml(player.name) + '" ' +
                        'data-company="' + escapeHtml(player.company || '') + '" ' +
                        'data-email="' + escapeHtml(player.email || '') + '">' +
                        '<div class="autocomplete-item-name">' + escapeHtml(player.name) + '</div>' +
                        (detailStr ? '<div class="autocomplete-item-location">' + escapeHtml(detailStr) + '</div>' : '') +
                    '</div>';
                }).join('');

                // Add click handlers to each suggestion
                playerDropdown.querySelectorAll('.player-autocomplete-item').forEach(function(item) {
                    item.addEventListener('click', function() {
                        document.getElementById('playerName').value = this.getAttribute('data-name');
                        document.getElementById('playerCompany').value = this.getAttribute('data-company');
                        document.getElementById('playerEmail').value = this.getAttribute('data-email');
                        playerDropdown.classList.remove('active');
                    });
                });
            }, 100);
        });

        // Close player dropdown when clicking outside
        playerNameInput.addEventListener('blur', function() {
            setTimeout(function() { playerDropdown.classList.remove('active'); }, 200);
        });

        // Let user press Enter in player fields to add
        ['playerName', 'playerCompany', 'playerEmail'].forEach(function(id) {
            document.getElementById(id).addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    document.getElementById('btnAddPlayer').click();
                }
            });
        });

        // ==========================================
        // PHOTO UPLOAD HANDLING
        // Converts photos to Base64 for storage in Firebase
        // ==========================================
        let photosArray = [];  // Stores Base64 photo strings for the current form

        function renderPhotosPreview() {
            const previewEl = document.getElementById('photosPreview');
            if (photosArray.length === 0) {
                previewEl.innerHTML = '';
                return;
            }
            previewEl.innerHTML = photosArray.map(function(photoData, index) {
                return '<div class="photo-thumb-container">' +
                    '<img class="photo-thumb" src="' + photoData + '" onclick="showPhotoViewer(\'' + index + '_form\')" />' +
                    '<button type="button" class="photo-thumb-remove" data-index="' + index + '">√ó</button>' +
                '</div>';
            }).join('');

            // Add remove handlers
            previewEl.querySelectorAll('.photo-thumb-remove').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    photosArray.splice(parseInt(this.dataset.index), 1);
                    renderPhotosPreview();
                });
            });
        }

        // Handle file selection
        document.getElementById('photoInput').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            files.forEach(function(file) {
                // No file size check here ‚Äî we compress first, then it'll be small enough

                // Convert to Base64
                const reader = new FileReader();
                reader.onload = function(event) {
                    // Resize the image to save space
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;

                        // Scale down to max 800px on longest side
                        // This keeps photos looking good while staying small
                        const maxSize = 800;
                        if (width > maxSize || height > maxSize) {
                            if (width > height) {
                                height = Math.round(height * maxSize / width);
                                width = maxSize;
                            } else {
                                width = Math.round(width * maxSize / height);
                                height = maxSize;
                            }
                        }

                        canvas.width = width;
                        canvas.height = height;
                        canvas.getContext('2d').drawImage(img, 0, 0, width, height);

                        // Compress as JPEG at 50% quality (good balance of quality vs size)
                        var compressed = canvas.toDataURL('image/jpeg', 0.5);
                        
                        // If still too large (over ~500KB as Base64), compress more
                        if (compressed.length > 700000) {
                            compressed = canvas.toDataURL('image/jpeg', 0.3);
                        }
                        
                        photosArray.push(compressed);
                        renderPhotosPreview();
                    };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            });

            // Reset the input so the same file can be selected again
            this.value = '';
        });

        // Show full-size photo viewer
        function showPhotoViewer(idStr) {
            const parts = idStr.split('_');
            const index = parseInt(parts[0]);
            const source = parts[1];  // 'form' or 'detail'

            let src = '';
            if (source === 'form') {
                src = photosArray[index];
            } else if (source === 'detail') {
                // Get from the detail modal image
                src = document.querySelectorAll('.detail-photo')[index].src;
            }

            if (src) {
                document.getElementById('photoViewerImg').src = src;
                document.getElementById('photoViewer').classList.add('active');
            }
        }

        // ==========================================
        // RATING OPTION STYLING
        // Makes rating/option boxes highlight when you click them
        // ==========================================
        document.querySelectorAll('.rating-option, .list-type-option').forEach(option => {
            option.addEventListener('click', function() {
                const radioName = this.querySelector('input[type="radio"]').name;
                // Remove highlight from all options with the same name
                document.querySelectorAll(`input[name="${radioName}"]`).forEach(radio => {
                    radio.closest('.rating-option, .list-type-option').classList.remove('selected');
                });
                // Add highlight to the clicked option
                this.classList.add('selected');
                this.querySelector('input[type="radio"]').checked = true;
                
                // If this is the Wishlist/Played toggle, switch the form fields
                if (radioName === 'listType') {
                    const selectedValue = this.querySelector('input[type="radio"]').value;
                    if (selectedValue === 'wishlist') {
                        showWishlistFields();
                    } else {
                        showPlayedFields();
                    }
                }
            });
        });

        // ==========================================
        // COURSE NAME INPUT HANDLER
        // Only auto-fills when you select from dropdown, not while typing
        // ==========================================
        let addressTimeout;
        let websiteTimeout;
        
        // We've removed the auto-fill on typing
        // Address/website will only fill when you select a course from the dropdown

        // ==========================================
        // FORM SUBMISSION - ADDING A NEW COURSE
        // When you click "Add Course" button, this saves to the right list
        // ==========================================
        console.log('Setting up form submit handler...');
        document.getElementById('courseForm').addEventListener('submit', function(e) {
            console.log('Form submitted!');
            e.preventDefault();
            
            const listType = document.querySelector('input[name="listType"]:checked').value;
            const courseName = document.getElementById('courseName').value;
            
            // Get shared location fields
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const state = document.getElementById('state').value;
            const country = document.getElementById('country').value;
            const website = document.getElementById('website').value;
            
            if (listType === 'wishlist') {
                // Add to wish list
                const newCourse = {
                    id: (editingId && editingType === 'wishlist') ? editingId : Date.now(),
                    name: courseName,
                    address: address,
                    city: city,
                    state: state,
                    country: country,
                    website: website,
                    heardFrom: document.getElementById('heardFrom').value,
                    rating: document.querySelector('input[name="rating"]:checked')?.value || '',
                    notes: document.getElementById('wishlistNotes').value,
                    dateAdded: new Date().toISOString()
                };
                
                if (editingId && editingType === 'wishlist') {
                    // Replace existing entry
                    const idx = wishlistCourses.findIndex(function(c) { return c.id === editingId; });
                    if (idx >= 0) {
                        wishlistCourses[idx] = newCourse;
                    } else {
                        wishlistCourses.push(newCourse);
                    }
                } else {
                    wishlistCourses.push(newCourse);
                }
                renderWishList();
            } else {
                // Add to played list
                const newRound = {
                    id: (editingId && editingType === 'played') ? editingId : Date.now(),
                    name: courseName,
                    address: address,
                    city: city,
                    state: state,
                    country: country,
                    website: website,
                    datePlayed: document.getElementById('datePlayed').value,
                    holes: document.querySelector('input[name="holes"]:checked')?.value || '18',
                    playedWith: playersArray.slice(),
                    score: document.getElementById('score').value,
                    notes: document.getElementById('playedNotes').value,
                    photos: photosArray.slice()
                };
                
                if (editingId && editingType === 'played') {
                    // Replace existing entry
                    const idx = playedCourses.findIndex(function(r) { return r.id === editingId; });
                    if (idx >= 0) {
                        playedCourses[idx] = newRound;
                    } else {
                        playedCourses.push(newRound);
                    }
                } else {
                    playedCourses.push(newRound);
                }
                renderPlayedList();
                
                // Check if this was moved from wishlist
                const wishlistId = sessionStorage.getItem('moveFromWishlist');
                if (wishlistId) {
                    // Ask if they want to remove from wish list
                    if (confirm(`"${courseName}" has been added to your played list!\n\nDo you want to remove it from your wish list?`)) {
                        wishlistCourses = wishlistCourses.filter(c => c.id !== parseInt(wishlistId));
                        renderWishList();
                    }
                    sessionStorage.removeItem('moveFromWishlist');
                }
            }
            
            saveData();
            this.reset();
            
            // Clear editing state
            editingId = null;
            editingType = null;
            document.getElementById('btnSubmitCourse').textContent = 'Add Course';
            document.getElementById('btnDeleteFromForm').style.display = 'none';
            
            // Clear the players list
            playersArray = [];
            renderPlayersList();
            
            // Clear photos
            photosArray = [];
            renderPhotosPreview();
            
            // Remove all highlights
            document.querySelectorAll('.rating-option, .list-type-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Reset to wishlist view
            document.getElementById('btnShowWishList').click();
            showWishlistFields();
        });

        // ==========================================
        // DISPLAY WISH LIST
        // Shows all courses you want to play
        // ==========================================
        // ==========================================
        // GOLF DIGEST RANKINGS DATABASE
        // 2025-2026 America's 100 Greatest + Top 100 Public
        // Used to show ranking badges on wishlist cards
        // ==========================================
        const golfDigestRankings = [
            // America's 100 Greatest (2025-2026)
            {name:"Pine Valley Golf Club",rank:1,list:"Top 100"},
            {name:"Augusta National Golf Club",rank:2,list:"Top 100"},
            {name:"Cypress Point Club",rank:3,list:"Top 100"},
            {name:"Shinnecock Hills Golf Club",rank:4,list:"Top 100"},
            {name:"Oakmont Country Club",rank:5,list:"Top 100"},
            {name:"Merion Golf Club",rank:6,list:"Top 100"},
            {name:"National Golf Links of America",rank:7,list:"Top 100"},
            {name:"Sand Hills Golf Club",rank:8,list:"Top 100"},
            {name:"Pebble Beach Golf Links",rank:9,list:"Top 100"},
            {name:"Fishers Island Club",rank:10,list:"Top 100"},
            {name:"Chicago Golf Club",rank:11,list:"Top 100"},
            {name:"Pinehurst No. 2",rank:12,list:"Top 100"},
            {name:"Winged Foot Golf Club",rank:13,list:"Top 100"},
            {name:"Seminole Golf Club",rank:14,list:"Top 100"},
            {name:"Streamsong Resort Red",rank:15,list:"Top 100 Public"},
            {name:"Crystal Downs Country Club",rank:16,list:"Top 100"},
            {name:"The Country Club",rank:17,list:"Top 100"},
            {name:"Prairie Dunes Country Club",rank:18,list:"Top 100"},
            {name:"Garden City Golf Club",rank:19,list:"Top 100"},
            {name:"Los Angeles Country Club",rank:20,list:"Top 100"},
            {name:"Oak Hill Country Club",rank:21,list:"Top 100"},
            {name:"Riviera Country Club",rank:22,list:"Top 100"},
            {name:"Pacific Dunes",rank:23,list:"Top 100"},
            {name:"Bandon Dunes Pacific Dunes",rank:23,list:"Top 100"},
            {name:"Shadow Creek Golf Course",rank:24,list:"Top 100"},
            {name:"Camargo Club",rank:25,list:"Top 100"},
            {name:"Whistling Straits",rank:26,list:"Top 100"},
            {name:"The Straits Course at Whistling Straits",rank:26,list:"Top 100"},
            {name:"Olympic Club",rank:27,list:"Top 100"},
            {name:"San Francisco Golf Club",rank:28,list:"Top 100"},
            {name:"Friar's Head",rank:29,list:"Top 100"},
            {name:"The Ocean Course at Kiawah Island",rank:30,list:"Top 100"},
            {name:"Kiawah Island Ocean Course",rank:30,list:"Top 100"},
            {name:"Southern Hills Country Club",rank:31,list:"Top 100"},
            {name:"Somerset Hills Country Club",rank:32,list:"Top 100"},
            {name:"Oakland Hills Country Club",rank:33,list:"Top 100"},
            {name:"Shoreacres",rank:34,list:"Top 100"},
            {name:"Bethpage Black",rank:38,list:"Top 100"},
            {name:"Bethpage State Park Golf Course",rank:38,list:"Top 100"},
            {name:"TPC Sawgrass",rank:41,list:"Top 100"},
            {name:"TPC Sawgrass Stadium Course",rank:41,list:"Top 100"},
            {name:"Baltusrol Golf Club",rank:42,list:"Top 100"},
            {name:"Bandon Dunes",rank:44,list:"Top 100"},
            {name:"Bandon Dunes Golf Resort",rank:44,list:"Top 100"},
            {name:"Erin Hills",rank:49,list:"Top 100"},
            {name:"Erin Hills Golf Course",rank:49,list:"Top 100"},
            {name:"Sleepy Hollow Country Club",rank:52,list:"Top 100"},
            {name:"Maidstone Club",rank:53,list:"Top 100"},
            {name:"Myopia Hunt Club",rank:54,list:"Top 100"},
            {name:"Bandon Trails",rank:61,list:"Top 100"},
            {name:"Bandon Dunes Bandon Trails",rank:61,list:"Top 100"},
            {name:"Congressional Country Club",rank:67,list:"Top 100"},
            {name:"The Lido",rank:69,list:"Top 100"},
            {name:"Sand Valley The Lido",rank:69,list:"Top 100"},
            {name:"CapRock Ranch",rank:72,list:"Top 100"},
            {name:"Quaker Ridge Golf Club",rank:75,list:"Top 100"},
            {name:"Kinloch Golf Club",rank:79,list:"Top 100"},
            {name:"Old MacDonald",rank:81,list:"Top 100"},
            {name:"Bandon Dunes Old MacDonald",rank:81,list:"Top 100"},
            {name:"Ladera Golf Club",rank:83,list:"Top 100"},
            {name:"Canyata",rank:86,list:"Top 100"},
            {name:"Hudson National Golf Club",rank:88,list:"Top 100"},
            {name:"The Kittansett Club",rank:89,list:"Top 100"},
            {name:"Plainfield Country Club",rank:90,list:"Top 100"},
            {name:"Boston Golf Club",rank:91,list:"Top 100"},
            {name:"Valhalla Golf Club",rank:94,list:"Top 100"},
            {name:"Aronimink Golf Club",rank:100,list:"Top 100"},
            // Top 100 Greatest Public (2025-2026)
            {name:"Pebble Beach Golf Links",rank:1,list:"Top 100 Public"},
            {name:"Pacific Dunes",rank:2,list:"Top 100 Public"},
            {name:"Shadow Creek",rank:3,list:"Top 100 Public"},
            {name:"Whistling Straits",rank:4,list:"Top 100 Public"},
            {name:"Kiawah Island Ocean Course",rank:5,list:"Top 100 Public"},
            {name:"Pinehurst No. 2",rank:6,list:"Top 100 Public"},
            {name:"Bethpage Black",rank:7,list:"Top 100 Public"},
            {name:"TPC Sawgrass",rank:8,list:"Top 100 Public"},
            {name:"Bandon Dunes",rank:9,list:"Top 100 Public"},
            {name:"Erin Hills",rank:10,list:"Top 100 Public"},
            {name:"Bandon Trails",rank:11,list:"Top 100 Public"},
            {name:"The Lido",rank:12,list:"Top 100 Public"},
            {name:"Old MacDonald",rank:14,list:"Top 100 Public"},
            {name:"Blackwolf Run River Course",rank:17,list:"Top 100 Public"},
            {name:"The River Course at Blackwolf Run",rank:17,list:"Top 100 Public"},
            {name:"Streamsong Red",rank:20,list:"Top 100 Public"},
            {name:"Sand Valley",rank:21,list:"Top 100 Public"},
            {name:"Sand Valley Golf Resort",rank:21,list:"Top 100 Public"},
            {name:"Kapalua Plantation Course",rank:23,list:"Top 100 Public"},
            {name:"Kapalua Golf",rank:23,list:"Top 100 Public"},
            {name:"Mammoth Dunes",rank:25,list:"Top 100 Public"},
            {name:"Sand Valley Mammoth Dunes",rank:25,list:"Top 100 Public"},
            {name:"Streamsong Blue",rank:26,list:"Top 100 Public"},
            {name:"Sheep Ranch",rank:27,list:"Top 100 Public"},
            {name:"Bandon Dunes Sheep Ranch",rank:27,list:"Top 100 Public"},
            {name:"Harbour Town Golf Links",rank:28,list:"Top 100 Public"},
            {name:"Primland Highland Course",rank:29,list:"Top 100 Public"},
            {name:"Streamsong Black",rank:33,list:"Top 100 Public"},
            {name:"Prairie Club Dunes",rank:36,list:"Top 100 Public"},
            {name:"Yale Golf Course",rank:38,list:"Top 100 Public"},
            {name:"Omni Homestead Cascades",rank:42,list:"Top 100 Public"},
            {name:"Tobacco Road",rank:44,list:"Top 100 Public"},
            {name:"Tobacco Road Golf Club",rank:44,list:"Top 100 Public"},
            {name:"SentryWorld",rank:49,list:"Top 100 Public"},
            {name:"Wolf Creek Golf Club",rank:59,list:"Top 100 Public"},
            {name:"Pine Needles",rank:60,list:"Top 100 Public"},
            {name:"Pine Needles Lodge",rank:60,list:"Top 100 Public"},
            {name:"Irish Course at Whistling Straits",rank:65,list:"Top 100 Public"},
            {name:"Lawsonia Links",rank:66,list:"Top 100 Public"},
            {name:"Cascata Golf Club",rank:74,list:"Top 100 Public"},
            {name:"Golden Horseshoe Gold",rank:75,list:"Top 100 Public"},
            {name:"Taconic Golf Club",rank:78,list:"Top 100 Public"},
            {name:"Trump National Doral Blue Monster",rank:86,list:"Top 100 Public"},
            {name:"Mid Pines",rank:88,list:"Top 100 Public"},
            {name:"Mid Pines Inn",rank:88,list:"Top 100 Public"},
            {name:"The Park at West Palm Beach",rank:89,list:"Top 100 Public"},
            {name:"Blackwolf Run Meadow Valleys",rank:92,list:"Top 100 Public"},
            {name:"Prairie Club Pines",rank:90,list:"Top 100 Public"},
            {name:"Southern Pines Golf Club",rank:98,list:"Top 100 Public"}
        ];

        // Fuzzy match a course name against the rankings database
        function getGolfDigestRanking(courseName) {
            if (!courseName) return null;
            const search = courseName.toLowerCase().replace(/[^a-z0-9\s]/g, '').trim();
            
            let bestMatch = null;
            let bestScore = 0;
            
            golfDigestRankings.forEach(function(entry) {
                const entryName = entry.name.toLowerCase().replace(/[^a-z0-9\s]/g, '').trim();
                
                // Exact match
                if (search === entryName) {
                    if (!bestMatch || entry.rank < bestMatch.rank) {
                        bestMatch = entry;
                        bestScore = 100;
                    }
                    return;
                }
                
                // One contains the other
                if (search.includes(entryName) || entryName.includes(search)) {
                    const score = Math.min(search.length, entryName.length) / Math.max(search.length, entryName.length) * 90;
                    if (score > bestScore) {
                        bestMatch = entry;
                        bestScore = score;
                    }
                }
                
                // Check if key words match (for courses with alternate names)
                const searchWords = search.split(/\s+/);
                const entryWords = entryName.split(/\s+/);
                const matchingWords = searchWords.filter(function(w) {
                    return w.length > 2 && entryWords.some(function(ew) { return ew.includes(w) || w.includes(ew); });
                });
                const wordScore = matchingWords.length / Math.max(searchWords.length, entryWords.length) * 80;
                if (wordScore > bestScore && wordScore > 50) {
                    bestMatch = entry;
                    bestScore = wordScore;
                }
            });
            
            return bestScore > 40 ? bestMatch : null;
        }

        function renderWishList() {
            const listEl = document.getElementById('wishList');
            
            if (wishlistCourses.length === 0) {
                listEl.innerHTML = `
                    <div class="card empty-state">
                        <div class="empty-state-icon">‚õ≥</div>
                        <p>No courses on your wish list yet!</p>
                        <p style="margin-top: 8px; font-size: 14px;">Click "Add" to add courses you want to play.</p>
                    </div>
                `;
                return;
            }
            
            const ratingLabels = {
                must: 'Must Play',
                would: 'Would Like',
                nearby: 'If Nearby'
            };
            
            const ratingClasses = {
                must: 'rating-must',
                would: 'rating-would',
                nearby: 'rating-nearby'
            };
            
            listEl.innerHTML = wishlistCourses.map(course => {
                // Build location string from city, state, country
                let locationStr = '';
                if (course.city || course.state || course.country) {
                    const parts = [];
                    if (course.city) parts.push(course.city);
                    if (course.state) parts.push(course.state);
                    if (course.country) parts.push(course.country);
                    locationStr = parts.join(', ');
                }
                
                // Check for Golf Digest ranking
                const gdRank = getGolfDigestRanking(course.name);

                return `
                    <div class="course-item" data-id="${course.id}" data-type="wishlist">
                        <div class="course-header">
                            <div class="course-name-area" style="flex: 1; min-width: 0;">
                                <div class="course-name">${course.name}</div>
                                ${locationStr ? `<a class="course-location map-link" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(course.name + ' ' + locationStr)}" target="_blank" onclick="event.stopPropagation();">üìç ${locationStr}</a>` : ''}
                                ${course.website ? `<a class="course-website-link" href="${course.website}" target="_blank" onclick="event.stopPropagation();">üåê ${course.website.replace(/^https?:\/\/(www\.)?/, '').replace(/\/$/, '')}</a>` : ''}
                                ${course.heardFrom ? `<div class="course-source">via ${course.heardFrom}</div>` : ''}
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px; flex-shrink: 0;">
                                ${course.rating ? `<div class="course-rating ${ratingClasses[course.rating]}">${ratingLabels[course.rating]}</div>` : ''}
                                ${gdRank ? `<div class="gd-ranking" onclick="event.stopPropagation();">
                                    <div class="gd-ranking-label">Golf Digest</div>
                                    <div class="gd-ranking-number">#${gdRank.rank}</div>
                                    <div class="gd-ranking-list">${gdRank.list}</div>
                                </div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            document.querySelectorAll('#wishList .course-item').forEach(item => {
                item.addEventListener('click', function() {
                    showCourseDetail(parseInt(this.dataset.id), 'wishlist');
                });
            });
        }

        // ==========================================
        // DISPLAY PLAYED LIST
        // Shows all courses you've played with stats
        // Groups by course name and counts times played
        // ==========================================
        function renderPlayedList() {
            const listEl = document.getElementById('playedList');
            
            if (playedCourses.length === 0) {
                listEl.innerHTML = `
                    <div class="card empty-state">
                        <div class="empty-state-icon">‚úÖ</div>
                        <p>No rounds recorded yet!</p>
                        <p style="margin-top: 8px; font-size: 14px;">Click "Add" to log courses you've played.</p>
                    </div>
                `;
                return;
            }
            
            // Group rounds by course name and count them
            const courseGroups = {};
            playedCourses.forEach(round => {
                if (!courseGroups[round.name]) {
                    courseGroups[round.name] = [];
                }
                courseGroups[round.name].push(round);
            });
            
            // Sort rounds by date (most recent first)
            Object.keys(courseGroups).forEach(courseName => {
                courseGroups[courseName].sort((a, b) => new Date(b.datePlayed) - new Date(a.datePlayed));
            });
            
            // Create HTML for each course group
            listEl.innerHTML = Object.keys(courseGroups).map(courseName => {
                const rounds = courseGroups[courseName];
                const timesPlayed = rounds.length;
                const mostRecent = rounds[0];
                
                // Build location string from city, state, country
                let locationStr = '';
                if (mostRecent.city || mostRecent.state || mostRecent.country) {
                    const parts = [];
                    if (mostRecent.city) parts.push(mostRecent.city);
                    if (mostRecent.state) parts.push(mostRecent.state);
                    if (mostRecent.country) parts.push(mostRecent.country);
                    locationStr = parts.join(', ');
                }
                
                return `
                    <div class="course-item" data-id="${mostRecent.id}" data-type="played" data-course-name="${courseName}">
                        <div class="course-header">
                            <div class="course-name">${courseName} <span style="font-size: 13px; font-weight: 400; color: #666;">üìÖ ${new Date(mostRecent.datePlayed).toLocaleDateString()}</span></div>
                            <div style="display: flex; gap: 6px;">
                                ${timesPlayed > 1 ? `<div class="times-played-badge">${timesPlayed}x played</div>` : ''}
                            </div>
                        </div>
                        ${mostRecent.score ? `<div class="course-location">üèåÔ∏è Score: ${mostRecent.score}</div>` : ''}
                        ${(() => {
                            // Build "played with" string from array or legacy string
                            let playedWithStr = '';
                            if (Array.isArray(mostRecent.playedWith) && mostRecent.playedWith.length > 0) {
                                playedWithStr = mostRecent.playedWith.map(p => p.name).join(', ');
                            } else if (typeof mostRecent.playedWith === 'string' && mostRecent.playedWith) {
                                playedWithStr = mostRecent.playedWith;
                            }
                            return playedWithStr ? `<div class="course-location">üë• ${playedWithStr}</div>` : '';
                        })()}
                        ${locationStr ? `<a class="course-source map-link" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(courseName + ' ' + locationStr)}" target="_blank" onclick="event.stopPropagation();">üìç ${locationStr}</a>` : ''}
                        ${(() => {
                            // Collect all photos from all rounds for this course
                            let allPhotos = [];
                            rounds.forEach(function(r) {
                                if (Array.isArray(r.photos)) {
                                    allPhotos = allPhotos.concat(r.photos);
                                }
                            });
                            if (allPhotos.length === 0) return '';
                            // Shuffle photos randomly then show up to 4
                            let shuffled = allPhotos.slice();
                            for (let i = shuffled.length - 1; i > 0; i--) {
                                const j = Math.floor(Math.random() * (i + 1));
                                const temp = shuffled[i];
                                shuffled[i] = shuffled[j];
                                shuffled[j] = temp;
                            }
                            const shown = shuffled.slice(0, 4);
                            const extra = allPhotos.length - shown.length;
                            return '<div class="list-photo-strip">' +
                                shown.map(function(p) {
                                    return '<img class="list-photo-thumb" src="' + p + '" />';
                                }).join('') +
                                (extra > 0 ? '<div class="list-photo-more">+' + extra + '</div>' : '') +
                            '</div>';
                        })()}
                    </div>
                `;
            }).join('');
            
            document.querySelectorAll('#playedList .course-item').forEach(item => {
                item.addEventListener('click', function() {
                    showPlayedCourseRounds(this.dataset.courseName);
                });
            });
        }

        // ==========================================
        // SHOW WISH LIST COURSE DETAIL POPUP
        // Displays all info for a course you want to play
        // ==========================================
        function showCourseDetail(courseId, listType) {
            currentListType = listType;
            
            if (listType === 'wishlist') {
                const course = wishlistCourses.find(c => c.id === courseId);
                if (!course) return;
                
                currentCourseId = courseId;
                
                const ratingLabels = {
                    must: 'üåü Must Play - Would make a special trip',
                    would: '‚≠ê Would Like to Play - If convenient',
                    nearby: '‚ú® Would Play if Nearby - If in the same city'
                };
                
                document.getElementById('modalCourseName').textContent = course.name;
                document.getElementById('modalContent').innerHTML = `
                    ${course.website ? `
                        <div class="detail-section">
                            <div class="detail-label">Website</div>
                            <div class="detail-value"><a href="${course.website}" target="_blank" style="color: #2a5298; text-decoration: underline;">${course.website}</a></div>
                        </div>
                    ` : ''}
                    
                    ${course.address ? `
                        <div class="detail-section">
                            <div class="detail-label">Address</div>
                            <div class="detail-value">${course.address}</div>
                        </div>
                    ` : ''}
                    
                    ${course.city ? `
                        <div class="detail-section">
                            <div class="detail-label">City</div>
                            <div class="detail-value">${course.city}</div>
                        </div>
                    ` : ''}
                    
                    ${course.state ? `
                        <div class="detail-section">
                            <div class="detail-label">State</div>
                            <div class="detail-value">${course.state}</div>
                        </div>
                    ` : ''}
                    
                    ${course.country ? `
                        <div class="detail-section">
                            <div class="detail-label">Country</div>
                            <div class="detail-value">${course.country}</div>
                        </div>
                    ` : ''}
                    
                    ${course.rating ? `
                        <div class="detail-section">
                            <div class="detail-label">Rating</div>
                            <div class="detail-value">${ratingLabels[course.rating]}</div>
                        </div>
                    ` : ''}
                    
                    ${course.heardFrom ? `
                        <div class="detail-section">
                            <div class="detail-label">Heard From</div>
                            <div class="detail-value">${course.heardFrom}</div>
                        </div>
                    ` : ''}
                    
                    ${course.notes ? `
                        <div class="detail-section">
                            <div class="detail-label">Notes</div>
                            <div class="detail-value">${course.notes}</div>
                        </div>
                    ` : ''}
                    
                    <div class="detail-section">
                        <div class="detail-label">Date Added</div>
                        <div class="detail-value">${new Date(course.dateAdded).toLocaleDateString()}</div>
                    </div>
                `;
                
                // Show "Mark as Played" button for wishlist courses
                document.getElementById('btnMarkAsPlayed').style.display = 'block';
                document.getElementById('courseModal').classList.add('active');
            }
        }

        // ==========================================
        // SHOW ALL ROUNDS FOR A PLAYED COURSE
        // When you click a course from played list, show all times you played it
        // ==========================================
        function showPlayedCourseRounds(courseName) {
            const rounds = playedCourses.filter(r => r.name === courseName);
            if (rounds.length === 0) return;
            
            currentListType = 'played';
            currentCourseId = courseName; // Store course name instead of single ID
            
            // Sort by date, most recent first
            rounds.sort((a, b) => new Date(b.datePlayed) - new Date(a.datePlayed));
            
            document.getElementById('modalCourseName').textContent = courseName;
            
            const roundsHtml = rounds.map((round, index) => {
                // Build location string
                let locationStr = '';
                if (round.city || round.state || round.country) {
                    const parts = [];
                    if (round.city) parts.push(round.city);
                    if (round.state) parts.push(round.state);
                    if (round.country) parts.push(round.country);
                    locationStr = parts.join(', ');
                }
                
                return `
                    <div class="detail-section" style="border-bottom: ${index < rounds.length - 1 ? '1px solid #e0e0e0' : 'none'}; padding-bottom: ${index < rounds.length - 1 ? '20px' : '0'}; margin-bottom: ${index < rounds.length - 1 ? '20px' : '0'};">
                        <div style="font-weight: 700; color: #1e3c72; margin-bottom: 12px;">Round ${index + 1} - ${new Date(round.datePlayed).toLocaleDateString()}</div>
                        
                        ${round.website ? `
                            <div style="margin-bottom: 8px;">
                                <span style="font-weight: 600; color: #666; font-size: 13px;">WEBSITE: </span>
                                <a href="${round.website}" target="_blank" style="color: #2a5298; text-decoration: underline;">${round.website}</a>
                            </div>
                        ` : ''}
                        
                        ${round.holes ? `
                            <div style="margin-bottom: 8px;">
                                <span style="font-weight: 600; color: #666; font-size: 13px;">HOLES: </span>
                                <span>${round.holes} holes</span>
                            </div>
                        ` : ''}
                        
                        ${round.score ? `
                            <div style="margin-bottom: 8px;">
                                <span style="font-weight: 600; color: #666; font-size: 13px;">SCORE: </span>
                                <span>${round.score}</span>
                            </div>
                        ` : ''}
                        
                        ${round.playedWith ? `
                            <div style="margin-bottom: 8px;">
                                <span style="font-weight: 600; color: #666; font-size: 13px;">PLAYED WITH: </span>
                                <span>${Array.isArray(round.playedWith) 
                                    ? round.playedWith.map(function(p) {
                                        let parts = [p.name];
                                        if (p.company) parts.push(p.company);
                                        if (p.email) parts.push(p.email);
                                        return parts.join(' ‚Äî ');
                                    }).join('; ')
                                    : round.playedWith}</span>
                            </div>
                        ` : ''}
                        
                        ${round.address ? `
                            <div style="margin-bottom: 8px;">
                                <span style="font-weight: 600; color: #666; font-size: 13px;">ADDRESS: </span>
                                <span>${round.address}</span>
                            </div>
                        ` : ''}
                        
                        ${locationStr ? `
                            <div style="margin-bottom: 8px;">
                                <span style="font-weight: 600; color: #666; font-size: 13px;">LOCATION: </span>
                                <span>${locationStr}</span>
                            </div>
                        ` : ''}
                        
                        ${round.notes ? `
                            <div style="margin-top: 12px;">
                                <div style="font-weight: 600; color: #666; font-size: 13px; margin-bottom: 4px;">NOTES:</div>
                                <div>${round.notes}</div>
                            </div>
                        ` : ''}
                        ${round.photos && round.photos.length > 0 ? `
                            <div style="margin-top: 12px;">
                                <div style="font-weight: 600; color: #666; font-size: 13px; margin-bottom: 8px;">PHOTOS:</div>
                                <div class="detail-photos">
                                    ${round.photos.map(function(photo, pIdx) {
                                        return '<img class="detail-photo" src="' + photo + '" onclick="showPhotoViewer(\'' + pIdx + '_detail\')" />';
                                    }).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            document.getElementById('modalContent').innerHTML = `
                <div style="margin-bottom: 12px; color: #666;">
                    Played ${rounds.length} time${rounds.length > 1 ? 's' : ''}
                </div>
                ${roundsHtml}
            `;
            
            // Hide "Mark as Played" button for played courses
            document.getElementById('btnMarkAsPlayed').style.display = 'none';
            document.getElementById('courseModal').classList.add('active');
        }

        // ==========================================
        // CLOSE POPUP BUTTONS
        // Different ways to close the detail popup
        // ==========================================
        document.getElementById('btnCloseModal').addEventListener('click', function() {
            document.getElementById('courseModal').classList.remove('active');
        });

        document.getElementById('courseModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('active');
            }
        });

        // ==========================================
        // MARK AS PLAYED BUTTON
        // Moves a course from wish list to the add form (played mode)
        // Pre-fills the course name so you can add round details
        // ==========================================
        document.getElementById('btnMarkAsPlayed').addEventListener('click', function() {
            // Find the course on the wish list
            const course = wishlistCourses.find(c => c.id === currentCourseId);
            if (!course) return;
            
            // Close the modal
            document.getElementById('courseModal').classList.remove('active');
            
            // Switch to Add form
            document.getElementById('btnShowAdd').click();
            
            // Select "Played" option
            document.querySelector('input[name="listType"][value="played"]').checked = true;
            document.querySelector('input[name="listType"][value="played"]').closest('.list-type-option').classList.add('selected');
            document.querySelector('input[name="listType"][value="wishlist"]').closest('.list-type-option').classList.remove('selected');
            showPlayedFields();
            
            // Pre-fill the course name
            document.getElementById('courseName').value = course.name;
            
            // Pre-fill location fields if available
            if (course.address) {
                document.getElementById('address').value = course.address;
            }
            if (course.city) {
                document.getElementById('city').value = course.city;
            }
            if (course.state) {
                document.getElementById('state').value = course.state;
            }
            if (course.country) {
                document.getElementById('country').value = course.country;
            }
            
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('datePlayed').value = today;
            
            // Scroll to top of form
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Optional: Ask if they want to remove from wish list after adding
            // We'll handle this after they submit the form
            sessionStorage.setItem('moveFromWishlist', currentCourseId);
        });

        // ==========================================
        // DELETE COURSE/ROUNDS BUTTON
        // Delete from wish list or all rounds of a played course
        // ==========================================
        document.getElementById('btnDeleteCourse').addEventListener('click', function() {
            if (currentListType === 'wishlist') {
                if (confirm('Are you sure you want to delete this course from your wish list?')) {
                    wishlistCourses = wishlistCourses.filter(c => c.id !== currentCourseId);
                    saveData();
                    renderWishList();
                    document.getElementById('courseModal').classList.remove('active');
                }
            } else if (currentListType === 'played') {
                const courseName = currentCourseId; // currentCourseId stores course name for played
                const roundCount = playedCourses.filter(r => r.name === courseName).length;
                
                if (confirm(`Are you sure you want to delete all ${roundCount} round${roundCount > 1 ? 's' : ''} at ${courseName}?`)) {
                    playedCourses = playedCourses.filter(r => r.name !== courseName);
                    saveData();
                    renderPlayedList();
                    document.getElementById('courseModal').classList.remove('active');
                }
            }
        });

        // ==========================================
        // EDIT COURSE BUTTON
        // Opens the form with existing course data pre-filled for editing
        // ==========================================
        document.getElementById('btnEditCourse').addEventListener('click', function() {
            // Close modal
            document.getElementById('courseModal').classList.remove('active');
            
            // Switch to Add form
            document.getElementById('btnShowAdd').click();
            
            if (currentListType === 'wishlist') {
                const course = wishlistCourses.find(c => c.id === currentCourseId);
                if (!course) return;
                
                // Select wishlist option
                document.querySelector('input[name="listType"][value="wishlist"]').checked = true;
                document.querySelector('input[name="listType"][value="wishlist"]').closest('.list-type-option').classList.add('selected');
                document.querySelector('input[name="listType"][value="played"]').closest('.list-type-option').classList.remove('selected');
                showWishlistFields();
                
                // Pre-fill all fields
                document.getElementById('courseName').value = course.name || '';
                document.getElementById('address').value = course.address || '';
                document.getElementById('city').value = course.city || '';
                document.getElementById('state').value = course.state || '';
                document.getElementById('country').value = course.country || '';
                document.getElementById('website').value = course.website || '';
                document.getElementById('heardFrom').value = course.heardFrom || '';
                document.getElementById('wishlistNotes').value = course.notes || '';
                
                // Set rating
                if (course.rating) {
                    const ratingRadio = document.querySelector(`input[name="rating"][value="${course.rating}"]`);
                    if (ratingRadio) {
                        ratingRadio.checked = true;
                        ratingRadio.closest('.rating-option').classList.add('selected');
                    }
                }
                
                // Track that we're editing (don't delete yet ‚Äî only replace on submit)
                editingId = currentCourseId;
                editingType = 'wishlist';
                document.getElementById('btnSubmitCourse').textContent = 'Save Changes';
                document.getElementById('btnDeleteFromForm').style.display = 'block';
                
            } else if (currentListType === 'played') {
                // For played courses, we need to handle multiple rounds
                // We'll just edit the most recent round for now
                const rounds = playedCourses.filter(r => r.name === currentCourseId);
                if (rounds.length === 0) return;
                
                const mostRecent = rounds.sort((a, b) => new Date(b.datePlayed) - new Date(a.datePlayed))[0];
                
                // Select played option
                document.querySelector('input[name="listType"][value="played"]').checked = true;
                document.querySelector('input[name="listType"][value="played"]').closest('.list-type-option').classList.add('selected');
                document.querySelector('input[name="listType"][value="wishlist"]').closest('.list-type-option').classList.remove('selected');
                showPlayedFields();
                
                // Pre-fill all fields
                document.getElementById('courseName').value = mostRecent.name || '';
                document.getElementById('address').value = mostRecent.address || '';
                document.getElementById('city').value = mostRecent.city || '';
                document.getElementById('state').value = mostRecent.state || '';
                document.getElementById('country').value = mostRecent.country || '';
                document.getElementById('website').value = mostRecent.website || '';
                document.getElementById('datePlayed').value = mostRecent.datePlayed || '';
                document.getElementById('score').value = mostRecent.score || '';
                document.getElementById('playedNotes').value = mostRecent.notes || '';
                
                // Load the players array for editing
                if (Array.isArray(mostRecent.playedWith)) {
                    playersArray = mostRecent.playedWith.slice();
                } else if (typeof mostRecent.playedWith === 'string' && mostRecent.playedWith) {
                    // Convert legacy string format to array
                    playersArray = mostRecent.playedWith.split(',').map(function(name) {
                        return { name: name.trim(), company: '', email: '' };
                    });
                } else {
                    playersArray = [];
                }
                renderPlayersList();
                
                // Load photos for editing
                if (Array.isArray(mostRecent.photos)) {
                    photosArray = mostRecent.photos.slice();
                } else {
                    photosArray = [];
                }
                renderPhotosPreview();
                
                // Set holes
                if (mostRecent.holes) {
                    const holesRadio = document.querySelector(`input[name="holes"][value="${mostRecent.holes}"]`);
                    if (holesRadio) {
                        holesRadio.checked = true;
                        holesRadio.closest('.rating-option').classList.add('selected');
                    }
                }
                
                // Track that we're editing (don't delete yet ‚Äî only replace on submit)
                editingId = mostRecent.id;
                editingType = 'played';
                document.getElementById('btnSubmitCourse').textContent = 'Save Changes';
                document.getElementById('btnDeleteFromForm').style.display = 'block';
            }
            
            // Scroll to top of form
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // ==========================================
        // DELETE FROM EDIT FORM
        // Only visible when editing an existing course
        // ==========================================
        document.getElementById('btnDeleteFromForm').addEventListener('click', function() {
            if (!editingId) return;
            
            if (editingType === 'wishlist') {
                if (confirm('Are you sure you want to delete this course from your wish list?')) {
                    wishlistCourses = wishlistCourses.filter(function(c) { return c.id !== editingId; });
                    saveData();
                    renderWishList();
                    
                    // Reset form and go back to wish list
                    editingId = null;
                    editingType = null;
                    document.getElementById('courseForm').reset();
                    document.getElementById('btnSubmitCourse').textContent = 'Add Course';
                    this.style.display = 'none';
                    playersArray = [];
                    renderPlayersList();
                    photosArray = [];
                    renderPhotosPreview();
                    document.getElementById('btnShowWishList').click();
                    showWishlistFields();
                }
            } else if (editingType === 'played') {
                if (confirm('Are you sure you want to delete this round?')) {
                    playedCourses = playedCourses.filter(function(r) { return r.id !== editingId; });
                    saveData();
                    renderPlayedList();
                    
                    // Reset form and go back to played list
                    editingId = null;
                    editingType = null;
                    document.getElementById('courseForm').reset();
                    document.getElementById('btnSubmitCourse').textContent = 'Add Course';
                    this.style.display = 'none';
                    playersArray = [];
                    renderPlayersList();
                    photosArray = [];
                    renderPhotosPreview();
                    document.getElementById('btnShowPlayedList').click();
                    showWishlistFields();
                }
            }
        });
    </script>
</body>
</html>